<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 16.0.0"/>
    <title>gppt API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note{color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.tip{color:#0a3622;background-color:#d1e7dd;border-color:#a3cfbb;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%230a3622%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%206a6%206%200%201%201%2010.174%204.31c-.203.196-.359.4-.453.619l-.762%201.769A.5.5%200%200%201%2010.5%2013a.5.5%200%200%201%200%201%20.5.5%200%200%201%200%201l-.224.447a1%201%200%200%201-.894.553H6.618a1%201%200%200%201-.894-.553L5.5%2015a.5.5%200%200%201%200-1%20.5.5%200%200%201%200-1%20.5.5%200%200%201-.46-.302l-.761-1.77a2%202%200%200%200-.453-.618A5.98%205.98%200%200%201%202%206m6-5a5%205%200%200%200-3.479%208.592c.263.254.514.564.676.941L5.83%2012h4.342l.632-1.467c.162-.377.413-.687.676-.941A5%205%200%200%200%208%201%22/%3E%3C/svg%3E");}.pdoc .alert.important{color:#055160;background-color:#cff4fc;border-color:#9eeaf9;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23055160%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%200a2%202%200%200%200-2%202v12a2%202%200%200%200%202%202h12a2%202%200%200%200%202-2V2a2%202%200%200%200-2-2zm6%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.caution{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M11.46.146A.5.5%200%200%200%2011.107%200H4.893a.5.5%200%200%200-.353.146L.146%204.54A.5.5%200%200%200%200%204.893v6.214a.5.5%200%200%200%20.146.353l4.394%204.394a.5.5%200%200%200%20.353.146h6.214a.5.5%200%200%200%20.353-.146l4.394-4.394a.5.5%200%200%200%20.146-.353V4.893a.5.5%200%200%200-.146-.353zM8%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:27px;vertical-align:bottom;width:50px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>


            <h2>Contents</h2>
            <ul>
  <li><a href="#gppt-get-pixivpy-token"><code>gppt</code>: get-pixivpy-token</a></li>
  <li><a href="#gppt-get-pixivpy-token"><code>md5-921cfcdbdc78ceeb46530402ec2fb6b4</code">: get-pixivpy-token</a>
  <ul>
    <li><a href="#install">Install</a></li>
    <li><a href="#enable-proxy">Enable Proxy</a></li>
    <li><a href="#run">Run</a></li>
    <li><a href="#help">Help</a></li>
  </ul></li>
</ul>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#AUTH_TOKEN_URL">AUTH_TOKEN_URL</a>
            </li>
            <li>
                    <a class="variable" href="#CALLBACK_URI">CALLBACK_URI</a>
            </li>
            <li>
                    <a class="variable" href="#CLIENT_ID">CLIENT_ID</a>
            </li>
            <li>
                    <a class="variable" href="#CLIENT_SECRET">CLIENT_SECRET</a>
            </li>
            <li>
                    <a class="variable" href="#LOGIN_URL">LOGIN_URL</a>
            </li>
            <li>
                    <a class="variable" href="#REDIRECT_URI">REDIRECT_URI</a>
            </li>
            <li>
                    <a class="variable" href="#USER_AGENT">USER_AGENT</a>
            </li>
            <li>
                    <a class="class" href="#GetPixivToken">GetPixivToken</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#GetPixivToken.__init__">GetPixivToken</a>
                        </li>
                        <li>
                                <a class="variable" href="#GetPixivToken.headless">headless</a>
                        </li>
                        <li>
                                <a class="variable" href="#GetPixivToken.username">username</a>
                        </li>
                        <li>
                                <a class="variable" href="#GetPixivToken.password">password</a>
                        </li>
                        <li>
                                <a class="variable" href="#GetPixivToken.browser">browser</a>
                        </li>
                        <li>
                                <a class="variable" href="#GetPixivToken.context">context</a>
                        </li>
                        <li>
                                <a class="variable" href="#GetPixivToken.page">page</a>
                        </li>
                        <li>
                                <a class="variable" href="#GetPixivToken.code">code</a>
                        </li>
                        <li>
                                <a class="function" href="#GetPixivToken.login">login</a>
                        </li>
                        <li>
                                <a class="function" href="#GetPixivToken.refresh">refresh</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#LoginCred">LoginCred</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#LoginCred.pixiv_id">pixiv_id</a>
                        </li>
                        <li>
                                <a class="variable" href="#LoginCred.password">password</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#LoginInfo">LoginInfo</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#LoginInfo.access_token">access_token</a>
                        </li>
                        <li>
                                <a class="variable" href="#LoginInfo.expires_in">expires_in</a>
                        </li>
                        <li>
                                <a class="variable" href="#LoginInfo.token_type">token_type</a>
                        </li>
                        <li>
                                <a class="variable" href="#LoginInfo.scope">scope</a>
                        </li>
                        <li>
                                <a class="variable" href="#LoginInfo.refresh_token">refresh_token</a>
                        </li>
                        <li>
                                <a class="variable" href="#LoginInfo.user">user</a>
                        </li>
                        <li>
                                <a class="variable" href="#LoginInfo.response">response</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#LoginUserInfo">LoginUserInfo</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#LoginUserInfo.profile_image_urls">profile_image_urls</a>
                        </li>
                        <li>
                                <a class="variable" href="#LoginUserInfo.id">id</a>
                        </li>
                        <li>
                                <a class="variable" href="#LoginUserInfo.name">name</a>
                        </li>
                        <li>
                                <a class="variable" href="#LoginUserInfo.account">account</a>
                        </li>
                        <li>
                                <a class="variable" href="#LoginUserInfo.mail_address">mail_address</a>
                        </li>
                        <li>
                                <a class="variable" href="#LoginUserInfo.is_premium">is_premium</a>
                        </li>
                        <li>
                                <a class="variable" href="#LoginUserInfo.x_restrict">x_restrict</a>
                        </li>
                        <li>
                                <a class="variable" href="#LoginUserInfo.is_mail_authorized">is_mail_authorized</a>
                        </li>
                        <li>
                                <a class="variable" href="#LoginUserInfo.require_policy_agreement">require_policy_agreement</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#OAuthAPIResponse">OAuthAPIResponse</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#OAuthAPIResponse.access_token">access_token</a>
                        </li>
                        <li>
                                <a class="variable" href="#OAuthAPIResponse.expires_in">expires_in</a>
                        </li>
                        <li>
                                <a class="variable" href="#OAuthAPIResponse.token_type">token_type</a>
                        </li>
                        <li>
                                <a class="variable" href="#OAuthAPIResponse.scope">scope</a>
                        </li>
                        <li>
                                <a class="variable" href="#OAuthAPIResponse.refresh_token">refresh_token</a>
                        </li>
                        <li>
                                <a class="variable" href="#OAuthAPIResponse.user">user</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#PixivAuth">PixivAuth</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#PixivAuth.__init__">PixivAuth</a>
                        </li>
                        <li>
                                <a class="variable" href="#PixivAuth.auth_json_path">auth_json_path</a>
                        </li>
                        <li>
                                <a class="function" href="#PixivAuth.auth">auth</a>
                        </li>
                        <li>
                                <a class="function" href="#PixivAuth.get_refresh_token">get_refresh_token</a>
                        </li>
                        <li>
                                <a class="function" href="#PixivAuth.read_client_cred">read_client_cred</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#PixivLoginFailedError">PixivLoginFailedError</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="class" href="#ProfileURIs">ProfileURIs</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#ProfileURIs.px_16x16">px_16x16</a>
                        </li>
                        <li>
                                <a class="variable" href="#ProfileURIs.px_50x50">px_50x50</a>
                        </li>
                        <li>
                                <a class="variable" href="#ProfileURIs.px_170x170">px_170x170</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22160%22%20viewBox%3D%220%200%20150%2080%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M132.316%2048.886c.276-4.679%202.342-6.698%204.409-7.982s4.27-1.165%206.751-1.055c1.586.07%203.044.156%204.222-.482%201.142-.619%202.026-1.932%202.162-3.739.268-3.576-1.929-5.368-5.006-5.551s-7.599.524-10.517%201.606c-4.455%201.652-8.588%206.606-9.552%208.992s-2.342%206.193-1.745%2010.873%202.664%209.221%205.878%2011.79%205.878%203.808%2010.103%204.312%203.444.229%206.062.229%205.006-2.202%204.914-4.909-2.296-5.001-4.501-4.863-3.077.505-5.281.229-7.715-2.064-7.899-9.451z%22%20fill%3D%22%23198754%22/%3E%3Ccircle%20cx%3D%22101.504%22%20cy%3D%2248.943%22%20r%3D%2214.208%22%20fill%3D%22none%22%20stroke%3D%22%23198754%22%20stroke-width%3D%229.354%22/%3E%3Cpath%20d%3D%22M87.81.002c-3.637.065-5.001.454-7.014%201.232s-3.443%201.363-6.3%204.282c-1.723%201.76-3.148%205.019-3.776%207.329-.413%201.521-.316%202.63-.316%202.63l-.195%2034.612c.065%205.774-6.755%208.305-9.612%208.37s-9.678-1.038-9.743-9.408%207.128-9.521%208.362-9.521c1.413-.13%202.526-.021%203.718-.016%202.071.009%204.157-.778%204.092-4.671s-4.157-4.736-4.157-4.736c-6.3-.843-11.43%202.206-11.43%202.206S40.917%2038.15%2041.372%2049.634%2051.568%2068.19%2061.311%2068.125s18.316-7.007%2018.445-17.193l.13-22.772c.046-2.291%202.683-3.644%204.476-4.203.745-.232%201.694-.274%201.694-.274l10.457-.13s4.871-.324%207.729-3.114%204.352-6.294%204.352-6.294.974-3.049.13-4.606-.195-1.233-2.792-3.309-8.573-4.477-8.573-4.477S91.447-.063%2087.81.002zM0%2047.169l.065%2028.417S0%2080.127%204.481%2079.997s5.072-3.866%205.049-4.152l-.113-28.482s1.624-7.656%209.937-7.721%2010.002%206.942%2010.002%208.499-.909%2010.51-9.093%2010.51c-.948%200-2.99-.567-4.145-.272-3.919%201-3.194%204.554-3.194%204.554s.065%205.061%207.404%204.996%2018.575-6.034%2018.575-19.074S26.953%2030.04%2019.549%2029.91%201.234%2035.296%200%2047.169z%22%20fill%3D%22%23198754%22/%3E%3Cg%20transform%3D%22matrix%28.325601%200%200%20.325256%20-10.32669%20-45.802786%29%22%3E%3Ccircle%20cx%3D%22297.554%22%20cy%3D%22172.286%22%20r%3D%2216.5%22%20fill%3D%22%23fff%22/%3E%3Cellipse%20cx%3D%22297.709%22%20cy%3D%22172.642%22%20rx%3D%2211.071%22%20ry%3D%2210.871%22%20fill%3D%22%23105a48%22/%3E%3Ccircle%20cx%3D%22304.104%22%20cy%3D%22167.667%22%20r%3D%224.5%22%20fill%3D%22%23fff%22/%3E%3C/g%3E%3Cpath%20d%3D%22M94.661%2017.032l.893-1.476s.99.714%201.916.925%201.575.114%202.955.114l14.565-.162c1.283-.032%203.085-.762%203.02-3.293s-.373-3.503-.373-3.503l1.283-.487s.52.503.877%201.573.309%201.995.292%202.66-.227%201.541-.227%201.541%201.564-.308%202.359-1.038.823-.779%201.489-1.508.812-.86.812-.86.552-.13.877.26.341.957.065%201.46-1.672%202.206-3.247%203.066-2.76%201.427-3.929%201.768-3.848.73-7.063.714l-10.944-.114s-2.143-.081-3.02-.373-2.241-.973-2.598-1.265z%22%20fill%3D%22%23d36d49%22/%3E%3Cg%20fill%3D%22%23105a48%22%3E%3Cellipse%20cx%3D%2293.052%22%20cy%3D%2243.567%22%20rx%3D%22.869%22%20ry%3D%221.014%22%20transform%3D%22rotate%28341.022%29%22/%3E%3Cellipse%20cx%3D%22104.3%22%20cy%3D%22-16.184%22%20rx%3D%22.865%22%20ry%3D%221.009%22%20transform%3D%22rotate%2814.786%29%22/%3E%3C/g%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
gppt    </h1>

                        <div class="docstring"><h1 id="gppt-get-pixivpy-token"><code><a href="">gppt</a></code>: get-pixivpy-token</h1>

<p><a href="https://pypi.org/project/gppt/
"><img src="https://img.shields.io/pypi/v/gppt?color=blue
  " alt="PyPI" /></a> <a href="https://github.com/eggplants/get-pixivpy-token/pkgs/container/get-pixivpy-token
"><img src="https://ghcr-badge.egpl.dev/eggplants/get-pixivpy-token/size
  " alt="ghcr" /></a> <a href="https://github.com/eggplants/scrapbox-client/actions/workflows/ci.yml
"><img src="https://github.com/eggplants/scrapbox-client/actions/workflows/ci.yml/badge.svg
  " alt="ci" /></a></p>

<ul>
<li>Get your Pixiv token (for running <a href="https://github.com/upbit/pixivpy">upbit/pixivpy</a>)</li>
<li>Refine <a href="https://gist.github.com/ZipFile/c9ebedb224406f4f11845ab700124362">pixiv_auth.py</a> + <a href="https://gist.github.com/upbit/6edda27cb1644e94183291109b8a5fde">its fork</a></li>
</ul>

<h2 id="install">Install</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>gppt
</code></pre>
</div>

<h2 id="enable-proxy">Enable Proxy</h2>

<p>Set <code>ALL_PROXY</code> or <code>HTTPS_PROXY</code> to your environment variables.</p>

<h2 id="run">Run</h2>

<h3 id="example">Example</h3>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">gppt</span><span class="w"> </span><span class="kn">import</span> <span class="n">GetPixivToken</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pixivpy3</span><span class="w"> </span><span class="kn">import</span> <span class="n">AppPixivAPI</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_refresh_token</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;token.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">refresh_token</span> <span class="o">:=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">refresh_token</span>

        <span class="n">g</span> <span class="o">=</span> <span class="n">GetPixivToken</span><span class="p">(</span><span class="n">headless</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">refresh_token</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;...&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;...&quot;</span><span class="p">)[</span><span class="s2">&quot;refresh_token&quot;</span><span class="p">]</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">refresh_token</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">refresh_token</span>

<span class="n">aapi</span> <span class="o">=</span> <span class="n">AppPixivAPI</span><span class="p">()</span>
<span class="n">aapi</span><span class="o">.</span><span class="n">auth</span><span class="p">(</span><span class="n">refresh_token</span><span class="o">=</span><span class="n">get_refresh_token</span><span class="p">())</span>
<span class="o">...</span>
</code></pre>
</div>

<h3 id="from-docker">From Docker</h3>

<pre><code>$ docker run --rm -it ghcr.io/eggplants/get-pixivpy-token lh -u &lt;id&gt; -p &lt;pw&gt;
[+]: Success!
access_token: ***
refresh_token: ***
expires_in: 3600
</code></pre>

<h3 id="from-cli">From CLI</h3>

<pre><code># with browser
$ gppt login
[!]: Chrome browser will be launched. Please login.
(Log in to Pixiv from the login screen that starts up.)
[+]: Success!
access_token: ***
refresh_token: ***
expires_in: 3600
...

# with headless browser
$ gppt login-headless -u &lt;id&gt; -p &lt;pw&gt;
[!]: Chrome browser will be launched. Please login.
[+]: Success!
access_token: ***
refresh_token: ***
expires_in: 3600
</code></pre>

<h3 id="from-library">From Library</h3>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">gppt</span><span class="w"> </span><span class="kn">import</span> <span class="n">GetPixivToken</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">GetPixivToken</span><span class="p">(</span><span class="n">headless</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">username</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">headless</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">username</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre>
</div>

<ul>
<li><code>res.response</code> returns:</li>
</ul>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;access_token&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;***&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;expires_in&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3600</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;refresh_token&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;***&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;scope&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;token_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bearer&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;account&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;***&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;***&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;is_mail_authorized&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;bool&gt;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;is_premium&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;bool&gt;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;mail_address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;***@***&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;***&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;profile_image_urls&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;px_16x16&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://s.pximg.net/common/images/no_profile_ss.png&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;px_170x170&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://s.pximg.net/common/images/no_profile.png&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;px_50x50&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://s.pximg.net/common/images/no_profile_s.png&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;require_policy_agreement&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;bool&gt;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;x_restrict&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<h2 id="help">Help</h2>

<pre><code>$ gppt -h
usage: gppt [-h]
            {login,l,login-interactive,li,login-headless,lh,refresh,r} ...

Get your Pixiv token (for running upbit/pixivpy)

positional arguments:
  {login,l,login-interactive,li,login-headless,lh,refresh,r}
    login (l)           retrieving auth token
    login-interactive (li)
                        `login` in interactive mode
    login-headless (lh)
                        `login` in headless mode
    refresh (r)         refresh tokens

optional arguments:
  -h, --help            show this help message and exit
</code></pre>

<pre><code>$ gppt l -h
usage: gppt login [-h] [-u USERNAME] [-p PASSWORD] [-j]

optional arguments:
  -h, --help            show this help message and exit
  -u USERNAME, --username USERNAME
                        your E-mail address / pixiv ID
  -p PASSWORD, --password PASSWORD
                        your current pixiv password
  -j, --json            output response as json
</code></pre>

<pre><code>$ gppt li -h
usage: gppt login-interactive [-h] [-j]

optional arguments:
  -h, --help  show this help message and exit
  -j, --json  output response as json
</code></pre>

<pre><code>$ gppt lh -h
usage: gppt login-headless [-h] -u USERNAME -p PASSWORD [-j]

optional arguments:
  -h, --help            show this help message and exit
  -u USERNAME, --username USERNAME
                        your E-mail address / pixiv ID
  -p PASSWORD, --password PASSWORD
                        your current pixiv password
  -j, --json            output response as json
</code></pre>

<pre><code>$ gppt r -h
usage: gppt refresh [-h] [-j] refresh_token

positional arguments:
  refresh_token

optional arguments:
  -h, --help     show this help message and exit
  -j, --json     output response as json
</code></pre>
</div>

                        <input id="mod-gppt-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-gppt-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="sd">&quot;&quot;&quot;.. include:: ../README.md&quot;&quot;&quot;</span>  <span class="c1"># noqa: D415</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">importlib.metadata</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a>
</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.auth</span><span class="w"> </span><span class="kn">import</span> <span class="n">PixivAuth</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.gppt</span><span class="w"> </span><span class="kn">import</span> <span class="n">GetPixivToken</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.model_types</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a>    <span class="n">LoginCred</span><span class="p">,</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a>    <span class="n">LoginInfo</span><span class="p">,</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a>    <span class="n">LoginUserInfo</span><span class="p">,</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a>    <span class="n">OAuthAPIResponse</span><span class="p">,</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a>    <span class="n">PixivLoginFailedError</span><span class="p">,</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a>    <span class="n">ProfileURIs</span><span class="p">,</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a><span class="p">)</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">15</span></a>
</span><span id="L-16"><a href="#L-16"><span class="linenos">16</span></a><span class="k">try</span><span class="p">:</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">17</span></a>    <span class="n">__version__</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">version</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">18</span></a><span class="k">except</span> <span class="n">importlib</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">PackageNotFoundError</span><span class="p">:</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">19</span></a>    <span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;0.0.0&quot;</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">20</span></a>
</span><span id="L-21"><a href="#L-21"><span class="linenos">21</span></a>
</span><span id="L-22"><a href="#L-22"><span class="linenos">22</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">23</span></a>    <span class="s2">&quot;AUTH_TOKEN_URL&quot;</span><span class="p">,</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">24</span></a>    <span class="s2">&quot;CALLBACK_URI&quot;</span><span class="p">,</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">25</span></a>    <span class="s2">&quot;CLIENT_ID&quot;</span><span class="p">,</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">26</span></a>    <span class="s2">&quot;CLIENT_SECRET&quot;</span><span class="p">,</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">27</span></a>    <span class="s2">&quot;LOGIN_URL&quot;</span><span class="p">,</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">28</span></a>    <span class="s2">&quot;REDIRECT_URI&quot;</span><span class="p">,</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">29</span></a>    <span class="s2">&quot;USER_AGENT&quot;</span><span class="p">,</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">30</span></a>    <span class="s2">&quot;GetPixivToken&quot;</span><span class="p">,</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">31</span></a>    <span class="s2">&quot;LoginCred&quot;</span><span class="p">,</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">32</span></a>    <span class="s2">&quot;LoginInfo&quot;</span><span class="p">,</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">33</span></a>    <span class="s2">&quot;LoginUserInfo&quot;</span><span class="p">,</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">34</span></a>    <span class="s2">&quot;OAuthAPIResponse&quot;</span><span class="p">,</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">35</span></a>    <span class="s2">&quot;PixivAuth&quot;</span><span class="p">,</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">36</span></a>    <span class="s2">&quot;PixivAuth&quot;</span><span class="p">,</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">37</span></a>    <span class="s2">&quot;PixivLoginFailedError&quot;</span><span class="p">,</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">38</span></a>    <span class="s2">&quot;ProfileURIs&quot;</span><span class="p">,</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">39</span></a><span class="p">]</span>
</span></pre></div>


            </section>
                <section id="AUTH_TOKEN_URL">
                    <div class="attr variable">
            <span class="name">AUTH_TOKEN_URL</span>

        
    </div>
    <a class="headerlink" href="#AUTH_TOKEN_URL"></a>
    
    

                </section>
                <section id="CALLBACK_URI">
                    <div class="attr variable">
            <span class="name">CALLBACK_URI</span>

        
    </div>
    <a class="headerlink" href="#CALLBACK_URI"></a>
    
    

                </section>
                <section id="CLIENT_ID">
                    <div class="attr variable">
            <span class="name">CLIENT_ID</span>

        
    </div>
    <a class="headerlink" href="#CLIENT_ID"></a>
    
    

                </section>
                <section id="CLIENT_SECRET">
                    <div class="attr variable">
            <span class="name">CLIENT_SECRET</span>

        
    </div>
    <a class="headerlink" href="#CLIENT_SECRET"></a>
    
    

                </section>
                <section id="LOGIN_URL">
                    <div class="attr variable">
            <span class="name">LOGIN_URL</span>

        
    </div>
    <a class="headerlink" href="#LOGIN_URL"></a>
    
    

                </section>
                <section id="REDIRECT_URI">
                    <div class="attr variable">
            <span class="name">REDIRECT_URI</span>

        
    </div>
    <a class="headerlink" href="#REDIRECT_URI"></a>
    
    

                </section>
                <section id="USER_AGENT">
                    <div class="attr variable">
            <span class="name">USER_AGENT</span>

        
    </div>
    <a class="headerlink" href="#USER_AGENT"></a>
    
    

                </section>
                <section id="GetPixivToken">
                            <input id="GetPixivToken-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">GetPixivToken</span>:

                <label class="view-source-button" for="GetPixivToken-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GetPixivToken"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GetPixivToken-46"><a href="#GetPixivToken-46"><span class="linenos"> 46</span></a><span class="k">class</span><span class="w"> </span><span class="nc">GetPixivToken</span><span class="p">:</span>
</span><span id="GetPixivToken-47"><a href="#GetPixivToken-47"><span class="linenos"> 47</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;GetPixivToken class for obtaining OAuth tokens from Pixiv.</span>
</span><span id="GetPixivToken-48"><a href="#GetPixivToken-48"><span class="linenos"> 48</span></a>
</span><span id="GetPixivToken-49"><a href="#GetPixivToken-49"><span class="linenos"> 49</span></a><span class="sd">    This class uses Playwright to automate the login process and retrieve the OAuth token.</span>
</span><span id="GetPixivToken-50"><a href="#GetPixivToken-50"><span class="linenos"> 50</span></a><span class="sd">    It supports both headless and non-headless modes for the browser.</span>
</span><span id="GetPixivToken-51"><a href="#GetPixivToken-51"><span class="linenos"> 51</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="GetPixivToken-52"><a href="#GetPixivToken-52"><span class="linenos"> 52</span></a>
</span><span id="GetPixivToken-53"><a href="#GetPixivToken-53"><span class="linenos"> 53</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="GetPixivToken-54"><a href="#GetPixivToken-54"><span class="linenos"> 54</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="GetPixivToken-55"><a href="#GetPixivToken-55"><span class="linenos"> 55</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="GetPixivToken-56"><a href="#GetPixivToken-56"><span class="linenos"> 56</span></a>        <span class="n">headless</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="GetPixivToken-57"><a href="#GetPixivToken-57"><span class="linenos"> 57</span></a>        <span class="n">username</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="GetPixivToken-58"><a href="#GetPixivToken-58"><span class="linenos"> 58</span></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="GetPixivToken-59"><a href="#GetPixivToken-59"><span class="linenos"> 59</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="GetPixivToken-60"><a href="#GetPixivToken-60"><span class="linenos"> 60</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the GetPixivToken class.</span>
</span><span id="GetPixivToken-61"><a href="#GetPixivToken-61"><span class="linenos"> 61</span></a>
</span><span id="GetPixivToken-62"><a href="#GetPixivToken-62"><span class="linenos"> 62</span></a><span class="sd">        Args:</span>
</span><span id="GetPixivToken-63"><a href="#GetPixivToken-63"><span class="linenos"> 63</span></a><span class="sd">            headless (bool | None): Whether to run the browser in headless mode. Defaults to False.</span>
</span><span id="GetPixivToken-64"><a href="#GetPixivToken-64"><span class="linenos"> 64</span></a><span class="sd">            username (str | None): The username for Pixiv login. Defaults to None.</span>
</span><span id="GetPixivToken-65"><a href="#GetPixivToken-65"><span class="linenos"> 65</span></a><span class="sd">            password (str | None): The password for Pixiv login. Defaults to None.</span>
</span><span id="GetPixivToken-66"><a href="#GetPixivToken-66"><span class="linenos"> 66</span></a>
</span><span id="GetPixivToken-67"><a href="#GetPixivToken-67"><span class="linenos"> 67</span></a><span class="sd">        Raises:</span>
</span><span id="GetPixivToken-68"><a href="#GetPixivToken-68"><span class="linenos"> 68</span></a><span class="sd">            ValueError: If headless mode is enabled but username or password is not provided.</span>
</span><span id="GetPixivToken-69"><a href="#GetPixivToken-69"><span class="linenos"> 69</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GetPixivToken-70"><a href="#GetPixivToken-70"><span class="linenos"> 70</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">headless</span> <span class="o">=</span> <span class="n">headless</span>
</span><span id="GetPixivToken-71"><a href="#GetPixivToken-71"><span class="linenos"> 71</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="n">username</span>
</span><span id="GetPixivToken-72"><a href="#GetPixivToken-72"><span class="linenos"> 72</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="n">password</span>
</span><span id="GetPixivToken-73"><a href="#GetPixivToken-73"><span class="linenos"> 73</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="p">:</span> <span class="n">Browser</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="GetPixivToken-74"><a href="#GetPixivToken-74"><span class="linenos"> 74</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">:</span> <span class="n">BrowserContext</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="GetPixivToken-75"><a href="#GetPixivToken-75"><span class="linenos"> 75</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="p">:</span> <span class="n">Page</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="GetPixivToken-76"><a href="#GetPixivToken-76"><span class="linenos"> 76</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="GetPixivToken-77"><a href="#GetPixivToken-77"><span class="linenos"> 77</span></a>
</span><span id="GetPixivToken-78"><a href="#GetPixivToken-78"><span class="linenos"> 78</span></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">login</span><span class="p">(</span>
</span><span id="GetPixivToken-79"><a href="#GetPixivToken-79"><span class="linenos"> 79</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="GetPixivToken-80"><a href="#GetPixivToken-80"><span class="linenos"> 80</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="GetPixivToken-81"><a href="#GetPixivToken-81"><span class="linenos"> 81</span></a>        <span class="n">headless</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="GetPixivToken-82"><a href="#GetPixivToken-82"><span class="linenos"> 82</span></a>        <span class="n">username</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="GetPixivToken-83"><a href="#GetPixivToken-83"><span class="linenos"> 83</span></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="GetPixivToken-84"><a href="#GetPixivToken-84"><span class="linenos"> 84</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LoginInfo</span><span class="p">:</span>
</span><span id="GetPixivToken-85"><a href="#GetPixivToken-85"><span class="linenos"> 85</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Login to Pixiv and obtain the OAuth token.</span>
</span><span id="GetPixivToken-86"><a href="#GetPixivToken-86"><span class="linenos"> 86</span></a>
</span><span id="GetPixivToken-87"><a href="#GetPixivToken-87"><span class="linenos"> 87</span></a><span class="sd">        This method uses Playwright to automate the login process and retrieve the OAuth token.</span>
</span><span id="GetPixivToken-88"><a href="#GetPixivToken-88"><span class="linenos"> 88</span></a>
</span><span id="GetPixivToken-89"><a href="#GetPixivToken-89"><span class="linenos"> 89</span></a><span class="sd">        Args:</span>
</span><span id="GetPixivToken-90"><a href="#GetPixivToken-90"><span class="linenos"> 90</span></a><span class="sd">            headless (bool | None): Whether to run the browser in headless mode. Defaults to None.</span>
</span><span id="GetPixivToken-91"><a href="#GetPixivToken-91"><span class="linenos"> 91</span></a><span class="sd">            username (str | None): The username for Pixiv login. Defaults to None.</span>
</span><span id="GetPixivToken-92"><a href="#GetPixivToken-92"><span class="linenos"> 92</span></a><span class="sd">            password (str | None): The password for Pixiv login. Defaults to None.</span>
</span><span id="GetPixivToken-93"><a href="#GetPixivToken-93"><span class="linenos"> 93</span></a>
</span><span id="GetPixivToken-94"><a href="#GetPixivToken-94"><span class="linenos"> 94</span></a><span class="sd">        Returns:</span>
</span><span id="GetPixivToken-95"><a href="#GetPixivToken-95"><span class="linenos"> 95</span></a><span class="sd">            LoginInfo: The login information containing the OAuth token and other details.</span>
</span><span id="GetPixivToken-96"><a href="#GetPixivToken-96"><span class="linenos"> 96</span></a>
</span><span id="GetPixivToken-97"><a href="#GetPixivToken-97"><span class="linenos"> 97</span></a><span class="sd">        Raises:</span>
</span><span id="GetPixivToken-98"><a href="#GetPixivToken-98"><span class="linenos"> 98</span></a><span class="sd">            ValueError: If headless mode is enabled but username or password is not provided.</span>
</span><span id="GetPixivToken-99"><a href="#GetPixivToken-99"><span class="linenos"> 99</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GetPixivToken-100"><a href="#GetPixivToken-100"><span class="linenos">100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__update_credentials</span><span class="p">(</span>
</span><span id="GetPixivToken-101"><a href="#GetPixivToken-101"><span class="linenos">101</span></a>            <span class="n">headless</span><span class="o">=</span><span class="n">headless</span><span class="p">,</span>
</span><span id="GetPixivToken-102"><a href="#GetPixivToken-102"><span class="linenos">102</span></a>            <span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span>
</span><span id="GetPixivToken-103"><a href="#GetPixivToken-103"><span class="linenos">103</span></a>            <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span>
</span><span id="GetPixivToken-104"><a href="#GetPixivToken-104"><span class="linenos">104</span></a>        <span class="p">)</span>
</span><span id="GetPixivToken-105"><a href="#GetPixivToken-105"><span class="linenos">105</span></a>        <span class="n">code_verifier</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__perform_browser_login</span><span class="p">()</span>
</span><span id="GetPixivToken-106"><a href="#GetPixivToken-106"><span class="linenos">106</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__exchange_code_for_token</span><span class="p">(</span><span class="n">code_verifier</span><span class="p">)</span>
</span><span id="GetPixivToken-107"><a href="#GetPixivToken-107"><span class="linenos">107</span></a>
</span><span id="GetPixivToken-108"><a href="#GetPixivToken-108"><span class="linenos">108</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__update_credentials</span><span class="p">(</span>
</span><span id="GetPixivToken-109"><a href="#GetPixivToken-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="GetPixivToken-110"><a href="#GetPixivToken-110"><span class="linenos">110</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="GetPixivToken-111"><a href="#GetPixivToken-111"><span class="linenos">111</span></a>        <span class="n">headless</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="GetPixivToken-112"><a href="#GetPixivToken-112"><span class="linenos">112</span></a>        <span class="n">username</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="GetPixivToken-113"><a href="#GetPixivToken-113"><span class="linenos">113</span></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="GetPixivToken-114"><a href="#GetPixivToken-114"><span class="linenos">114</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="GetPixivToken-115"><a href="#GetPixivToken-115"><span class="linenos">115</span></a>        <span class="k">if</span> <span class="n">headless</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="GetPixivToken-116"><a href="#GetPixivToken-116"><span class="linenos">116</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">headless</span> <span class="o">=</span> <span class="n">headless</span>
</span><span id="GetPixivToken-117"><a href="#GetPixivToken-117"><span class="linenos">117</span></a>        <span class="k">if</span> <span class="n">username</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="GetPixivToken-118"><a href="#GetPixivToken-118"><span class="linenos">118</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="n">username</span>
</span><span id="GetPixivToken-119"><a href="#GetPixivToken-119"><span class="linenos">119</span></a>        <span class="k">if</span> <span class="n">password</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="GetPixivToken-120"><a href="#GetPixivToken-120"><span class="linenos">120</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="n">password</span>
</span><span id="GetPixivToken-121"><a href="#GetPixivToken-121"><span class="linenos">121</span></a>
</span><span id="GetPixivToken-122"><a href="#GetPixivToken-122"><span class="linenos">122</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headless</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="GetPixivToken-123"><a href="#GetPixivToken-123"><span class="linenos">123</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">headless</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="GetPixivToken-124"><a href="#GetPixivToken-124"><span class="linenos">124</span></a>
</span><span id="GetPixivToken-125"><a href="#GetPixivToken-125"><span class="linenos">125</span></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">__perform_browser_login</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="GetPixivToken-126"><a href="#GetPixivToken-126"><span class="linenos">126</span></a>        <span class="k">async</span> <span class="k">with</span> <span class="n">async_playwright</span><span class="p">()</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
</span><span id="GetPixivToken-127"><a href="#GetPixivToken-127"><span class="linenos">127</span></a>            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__setup_browser</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="GetPixivToken-128"><a href="#GetPixivToken-128"><span class="linenos">128</span></a>            <span class="n">code_verifier</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__navigate_and_login</span><span class="p">()</span>
</span><span id="GetPixivToken-129"><a href="#GetPixivToken-129"><span class="linenos">129</span></a>
</span><span id="GetPixivToken-130"><a href="#GetPixivToken-130"><span class="linenos">130</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">browser</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="GetPixivToken-131"><a href="#GetPixivToken-131"><span class="linenos">131</span></a>                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="GetPixivToken-132"><a href="#GetPixivToken-132"><span class="linenos">132</span></a>
</span><span id="GetPixivToken-133"><a href="#GetPixivToken-133"><span class="linenos">133</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="GetPixivToken-134"><a href="#GetPixivToken-134"><span class="linenos">134</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Failed to capture OAuth code from callback URL&quot;</span>
</span><span id="GetPixivToken-135"><a href="#GetPixivToken-135"><span class="linenos">135</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="GetPixivToken-136"><a href="#GetPixivToken-136"><span class="linenos">136</span></a>
</span><span id="GetPixivToken-137"><a href="#GetPixivToken-137"><span class="linenos">137</span></a>        <span class="k">return</span> <span class="n">code_verifier</span>
</span><span id="GetPixivToken-138"><a href="#GetPixivToken-138"><span class="linenos">138</span></a>
</span><span id="GetPixivToken-139"><a href="#GetPixivToken-139"><span class="linenos">139</span></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">__setup_browser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="n">AsyncPlaywright</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="GetPixivToken-140"><a href="#GetPixivToken-140"><span class="linenos">140</span></a>        <span class="n">install</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">chromium</span><span class="p">],</span> <span class="n">with_deps</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="GetPixivToken-141"><a href="#GetPixivToken-141"><span class="linenos">141</span></a>        <span class="n">browser_options</span> <span class="o">=</span> <span class="n">_get_browser_options</span><span class="p">(</span><span class="n">headless</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headless</span><span class="p">)</span>
</span><span id="GetPixivToken-142"><a href="#GetPixivToken-142"><span class="linenos">142</span></a>
</span><span id="GetPixivToken-143"><a href="#GetPixivToken-143"><span class="linenos">143</span></a>        <span class="c1"># Extract proxy and args from options</span>
</span><span id="GetPixivToken-144"><a href="#GetPixivToken-144"><span class="linenos">144</span></a>        <span class="n">proxy</span> <span class="o">=</span> <span class="n">browser_options</span><span class="p">[</span><span class="s2">&quot;proxy&quot;</span><span class="p">]</span>
</span><span id="GetPixivToken-145"><a href="#GetPixivToken-145"><span class="linenos">145</span></a>        <span class="n">args</span> <span class="o">=</span> <span class="n">browser_options</span><span class="p">[</span><span class="s2">&quot;args&quot;</span><span class="p">]</span>
</span><span id="GetPixivToken-146"><a href="#GetPixivToken-146"><span class="linenos">146</span></a>        <span class="n">headless</span> <span class="o">=</span> <span class="n">browser_options</span><span class="p">[</span><span class="s2">&quot;headless&quot;</span><span class="p">]</span>
</span><span id="GetPixivToken-147"><a href="#GetPixivToken-147"><span class="linenos">147</span></a>
</span><span id="GetPixivToken-148"><a href="#GetPixivToken-148"><span class="linenos">148</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">browser</span> <span class="o">=</span> <span class="k">await</span> <span class="n">p</span><span class="o">.</span><span class="n">chromium</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span>
</span><span id="GetPixivToken-149"><a href="#GetPixivToken-149"><span class="linenos">149</span></a>            <span class="n">headless</span><span class="o">=</span><span class="n">headless</span><span class="p">,</span>
</span><span id="GetPixivToken-150"><a href="#GetPixivToken-150"><span class="linenos">150</span></a>            <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span>
</span><span id="GetPixivToken-151"><a href="#GetPixivToken-151"><span class="linenos">151</span></a>        <span class="p">)</span>
</span><span id="GetPixivToken-152"><a href="#GetPixivToken-152"><span class="linenos">152</span></a>
</span><span id="GetPixivToken-153"><a href="#GetPixivToken-153"><span class="linenos">153</span></a>        <span class="n">context_options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="GetPixivToken-154"><a href="#GetPixivToken-154"><span class="linenos">154</span></a>        <span class="k">if</span> <span class="n">proxy</span><span class="p">:</span>
</span><span id="GetPixivToken-155"><a href="#GetPixivToken-155"><span class="linenos">155</span></a>            <span class="n">context_options</span><span class="p">[</span><span class="s2">&quot;proxy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">proxy</span>
</span><span id="GetPixivToken-156"><a href="#GetPixivToken-156"><span class="linenos">156</span></a>
</span><span id="GetPixivToken-157"><a href="#GetPixivToken-157"><span class="linenos">157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">context</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">new_context</span><span class="p">(</span><span class="o">**</span><span class="n">context_options</span><span class="p">)</span>
</span><span id="GetPixivToken-158"><a href="#GetPixivToken-158"><span class="linenos">158</span></a>
</span><span id="GetPixivToken-159"><a href="#GetPixivToken-159"><span class="linenos">159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">new_page</span><span class="p">()</span>
</span><span id="GetPixivToken-160"><a href="#GetPixivToken-160"><span class="linenos">160</span></a>
</span><span id="GetPixivToken-161"><a href="#GetPixivToken-161"><span class="linenos">161</span></a>        <span class="c1"># Set up network listener to capture the OAuth callback URL</span>
</span><span id="GetPixivToken-162"><a href="#GetPixivToken-162"><span class="linenos">162</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="GetPixivToken-163"><a href="#GetPixivToken-163"><span class="linenos">163</span></a>
</span><span id="GetPixivToken-164"><a href="#GetPixivToken-164"><span class="linenos">164</span></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">handle_request</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">Request</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="GetPixivToken-165"><a href="#GetPixivToken-165"><span class="linenos">165</span></a>            <span class="n">url</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">url</span>
</span><span id="GetPixivToken-166"><a href="#GetPixivToken-166"><span class="linenos">166</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;pixiv://&quot;</span><span class="p">):</span>
</span><span id="GetPixivToken-167"><a href="#GetPixivToken-167"><span class="linenos">167</span></a>                <span class="k">return</span>
</span><span id="GetPixivToken-168"><a href="#GetPixivToken-168"><span class="linenos">168</span></a>            <span class="k">if</span> <span class="n">m</span> <span class="o">:=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;code=([^&amp;]*)&quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">):</span>
</span><span id="GetPixivToken-169"><a href="#GetPixivToken-169"><span class="linenos">169</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="GetPixivToken-170"><a href="#GetPixivToken-170"><span class="linenos">170</span></a>
</span><span id="GetPixivToken-171"><a href="#GetPixivToken-171"><span class="linenos">171</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="s2">&quot;request&quot;</span><span class="p">,</span> <span class="n">handle_request</span><span class="p">)</span>
</span><span id="GetPixivToken-172"><a href="#GetPixivToken-172"><span class="linenos">172</span></a>
</span><span id="GetPixivToken-173"><a href="#GetPixivToken-173"><span class="linenos">173</span></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">__navigate_and_login</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="GetPixivToken-174"><a href="#GetPixivToken-174"><span class="linenos">174</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>  <span class="c1"># noqa: S101</span>
</span><span id="GetPixivToken-175"><a href="#GetPixivToken-175"><span class="linenos">175</span></a>
</span><span id="GetPixivToken-176"><a href="#GetPixivToken-176"><span class="linenos">176</span></a>        <span class="n">code_verifier</span><span class="p">,</span> <span class="n">code_challenge</span> <span class="o">=</span> <span class="n">_oauth_pkce</span><span class="p">()</span>
</span><span id="GetPixivToken-177"><a href="#GetPixivToken-177"><span class="linenos">177</span></a>        <span class="n">login_params</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="GetPixivToken-178"><a href="#GetPixivToken-178"><span class="linenos">178</span></a>            <span class="s2">&quot;code_challenge&quot;</span><span class="p">:</span> <span class="n">code_challenge</span><span class="p">,</span>
</span><span id="GetPixivToken-179"><a href="#GetPixivToken-179"><span class="linenos">179</span></a>            <span class="s2">&quot;code_challenge_method&quot;</span><span class="p">:</span> <span class="s2">&quot;S256&quot;</span><span class="p">,</span>
</span><span id="GetPixivToken-180"><a href="#GetPixivToken-180"><span class="linenos">180</span></a>            <span class="s2">&quot;client&quot;</span><span class="p">:</span> <span class="s2">&quot;pixiv-android&quot;</span><span class="p">,</span>
</span><span id="GetPixivToken-181"><a href="#GetPixivToken-181"><span class="linenos">181</span></a>        <span class="p">}</span>
</span><span id="GetPixivToken-182"><a href="#GetPixivToken-182"><span class="linenos">182</span></a>
</span><span id="GetPixivToken-183"><a href="#GetPixivToken-183"><span class="linenos">183</span></a>        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">LOGIN_URL</span><span class="si">}</span><span class="s2">?</span><span class="si">{</span><span class="n">urlencode</span><span class="p">(</span><span class="n">login_params</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="GetPixivToken-184"><a href="#GetPixivToken-184"><span class="linenos">184</span></a>
</span><span id="GetPixivToken-185"><a href="#GetPixivToken-185"><span class="linenos">185</span></a>        <span class="c1"># Wait for login form to appear</span>
</span><span id="GetPixivToken-186"><a href="#GetPixivToken-186"><span class="linenos">186</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="GetPixivToken-187"><a href="#GetPixivToken-187"><span class="linenos">187</span></a>            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">wait_for_selector</span><span class="p">(</span><span class="s2">&quot;.sc-bn9ph6-6&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">20000</span><span class="p">)</span>
</span><span id="GetPixivToken-188"><a href="#GetPixivToken-188"><span class="linenos">188</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="GetPixivToken-189"><a href="#GetPixivToken-189"><span class="linenos">189</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Login form is not appeared. Please check connectivity for </span><span class="si">{</span><span class="n">LOGIN_URL</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="GetPixivToken-190"><a href="#GetPixivToken-190"><span class="linenos">190</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="GetPixivToken-191"><a href="#GetPixivToken-191"><span class="linenos">191</span></a>
</span><span id="GetPixivToken-192"><a href="#GetPixivToken-192"><span class="linenos">192</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="GetPixivToken-193"><a href="#GetPixivToken-193"><span class="linenos">193</span></a>            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__fill_login_form</span><span class="p">()</span>
</span><span id="GetPixivToken-194"><a href="#GetPixivToken-194"><span class="linenos">194</span></a>            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__try_login</span><span class="p">()</span>
</span><span id="GetPixivToken-195"><a href="#GetPixivToken-195"><span class="linenos">195</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="GetPixivToken-196"><a href="#GetPixivToken-196"><span class="linenos">196</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Waiting for manual login.&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>  <span class="c1"># noqa: T201</span>
</span><span id="GetPixivToken-197"><a href="#GetPixivToken-197"><span class="linenos">197</span></a>            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__wait_for_redirect</span><span class="p">()</span>
</span><span id="GetPixivToken-198"><a href="#GetPixivToken-198"><span class="linenos">198</span></a>
</span><span id="GetPixivToken-199"><a href="#GetPixivToken-199"><span class="linenos">199</span></a>        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">wait_for_timeout</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
</span><span id="GetPixivToken-200"><a href="#GetPixivToken-200"><span class="linenos">200</span></a>
</span><span id="GetPixivToken-201"><a href="#GetPixivToken-201"><span class="linenos">201</span></a>        <span class="k">return</span> <span class="n">code_verifier</span>
</span><span id="GetPixivToken-202"><a href="#GetPixivToken-202"><span class="linenos">202</span></a>
</span><span id="GetPixivToken-203"><a href="#GetPixivToken-203"><span class="linenos">203</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__exchange_code_for_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code_verifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LoginInfo</span><span class="p">:</span>
</span><span id="GetPixivToken-204"><a href="#GetPixivToken-204"><span class="linenos">204</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span><span id="GetPixivToken-205"><a href="#GetPixivToken-205"><span class="linenos">205</span></a>            <span class="n">AUTH_TOKEN_URL</span><span class="p">,</span>
</span><span id="GetPixivToken-206"><a href="#GetPixivToken-206"><span class="linenos">206</span></a>            <span class="n">data</span><span class="o">=</span><span class="p">{</span>
</span><span id="GetPixivToken-207"><a href="#GetPixivToken-207"><span class="linenos">207</span></a>                <span class="s2">&quot;client_id&quot;</span><span class="p">:</span> <span class="n">CLIENT_ID</span><span class="p">,</span>
</span><span id="GetPixivToken-208"><a href="#GetPixivToken-208"><span class="linenos">208</span></a>                <span class="s2">&quot;client_secret&quot;</span><span class="p">:</span> <span class="n">CLIENT_SECRET</span><span class="p">,</span>
</span><span id="GetPixivToken-209"><a href="#GetPixivToken-209"><span class="linenos">209</span></a>                <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">code</span><span class="p">,</span>
</span><span id="GetPixivToken-210"><a href="#GetPixivToken-210"><span class="linenos">210</span></a>                <span class="s2">&quot;code_verifier&quot;</span><span class="p">:</span> <span class="n">code_verifier</span><span class="p">,</span>
</span><span id="GetPixivToken-211"><a href="#GetPixivToken-211"><span class="linenos">211</span></a>                <span class="s2">&quot;grant_type&quot;</span><span class="p">:</span> <span class="s2">&quot;authorization_code&quot;</span><span class="p">,</span>
</span><span id="GetPixivToken-212"><a href="#GetPixivToken-212"><span class="linenos">212</span></a>                <span class="s2">&quot;include_policy&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span><span class="p">,</span>
</span><span id="GetPixivToken-213"><a href="#GetPixivToken-213"><span class="linenos">213</span></a>                <span class="s2">&quot;redirect_uri&quot;</span><span class="p">:</span> <span class="n">CALLBACK_URI</span><span class="p">,</span>
</span><span id="GetPixivToken-214"><a href="#GetPixivToken-214"><span class="linenos">214</span></a>            <span class="p">},</span>
</span><span id="GetPixivToken-215"><a href="#GetPixivToken-215"><span class="linenos">215</span></a>            <span class="n">headers</span><span class="o">=</span><span class="p">{</span>
</span><span id="GetPixivToken-216"><a href="#GetPixivToken-216"><span class="linenos">216</span></a>                <span class="s2">&quot;user-agent&quot;</span><span class="p">:</span> <span class="n">USER_AGENT</span><span class="p">,</span>
</span><span id="GetPixivToken-217"><a href="#GetPixivToken-217"><span class="linenos">217</span></a>                <span class="s2">&quot;app-os-version&quot;</span><span class="p">:</span> <span class="s2">&quot;14.6&quot;</span><span class="p">,</span>
</span><span id="GetPixivToken-218"><a href="#GetPixivToken-218"><span class="linenos">218</span></a>                <span class="s2">&quot;app-os&quot;</span><span class="p">:</span> <span class="s2">&quot;ios&quot;</span><span class="p">,</span>
</span><span id="GetPixivToken-219"><a href="#GetPixivToken-219"><span class="linenos">219</span></a>            <span class="p">},</span>
</span><span id="GetPixivToken-220"><a href="#GetPixivToken-220"><span class="linenos">220</span></a>            <span class="n">proxies</span><span class="o">=</span><span class="n">PROXIES</span><span class="p">,</span>
</span><span id="GetPixivToken-221"><a href="#GetPixivToken-221"><span class="linenos">221</span></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">TIMEOUT</span><span class="p">,</span>
</span><span id="GetPixivToken-222"><a href="#GetPixivToken-222"><span class="linenos">222</span></a>        <span class="p">)</span>
</span><span id="GetPixivToken-223"><a href="#GetPixivToken-223"><span class="linenos">223</span></a>
</span><span id="GetPixivToken-224"><a href="#GetPixivToken-224"><span class="linenos">224</span></a>        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;LoginInfo&quot;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
</span><span id="GetPixivToken-225"><a href="#GetPixivToken-225"><span class="linenos">225</span></a>
</span><span id="GetPixivToken-226"><a href="#GetPixivToken-226"><span class="linenos">226</span></a>    <span class="nd">@staticmethod</span>
</span><span id="GetPixivToken-227"><a href="#GetPixivToken-227"><span class="linenos">227</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">refresh</span><span class="p">(</span><span class="n">refresh_token</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LoginInfo</span><span class="p">:</span>
</span><span id="GetPixivToken-228"><a href="#GetPixivToken-228"><span class="linenos">228</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Refresh the OAuth token using the refresh token.</span>
</span><span id="GetPixivToken-229"><a href="#GetPixivToken-229"><span class="linenos">229</span></a>
</span><span id="GetPixivToken-230"><a href="#GetPixivToken-230"><span class="linenos">230</span></a><span class="sd">        This method sends a request to the Pixiv API to refresh the token.</span>
</span><span id="GetPixivToken-231"><a href="#GetPixivToken-231"><span class="linenos">231</span></a>
</span><span id="GetPixivToken-232"><a href="#GetPixivToken-232"><span class="linenos">232</span></a><span class="sd">        Args:</span>
</span><span id="GetPixivToken-233"><a href="#GetPixivToken-233"><span class="linenos">233</span></a><span class="sd">            refresh_token (str): The refresh token obtained during login.</span>
</span><span id="GetPixivToken-234"><a href="#GetPixivToken-234"><span class="linenos">234</span></a>
</span><span id="GetPixivToken-235"><a href="#GetPixivToken-235"><span class="linenos">235</span></a><span class="sd">        Returns:</span>
</span><span id="GetPixivToken-236"><a href="#GetPixivToken-236"><span class="linenos">236</span></a><span class="sd">            LoginInfo: The login information containing the new OAuth token and other details.</span>
</span><span id="GetPixivToken-237"><a href="#GetPixivToken-237"><span class="linenos">237</span></a>
</span><span id="GetPixivToken-238"><a href="#GetPixivToken-238"><span class="linenos">238</span></a><span class="sd">        Raises:</span>
</span><span id="GetPixivToken-239"><a href="#GetPixivToken-239"><span class="linenos">239</span></a><span class="sd">            ValueError: If the refresh token is not provided.</span>
</span><span id="GetPixivToken-240"><a href="#GetPixivToken-240"><span class="linenos">240</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GetPixivToken-241"><a href="#GetPixivToken-241"><span class="linenos">241</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span><span id="GetPixivToken-242"><a href="#GetPixivToken-242"><span class="linenos">242</span></a>            <span class="n">AUTH_TOKEN_URL</span><span class="p">,</span>
</span><span id="GetPixivToken-243"><a href="#GetPixivToken-243"><span class="linenos">243</span></a>            <span class="n">data</span><span class="o">=</span><span class="p">{</span>
</span><span id="GetPixivToken-244"><a href="#GetPixivToken-244"><span class="linenos">244</span></a>                <span class="s2">&quot;client_id&quot;</span><span class="p">:</span> <span class="n">CLIENT_ID</span><span class="p">,</span>
</span><span id="GetPixivToken-245"><a href="#GetPixivToken-245"><span class="linenos">245</span></a>                <span class="s2">&quot;client_secret&quot;</span><span class="p">:</span> <span class="n">CLIENT_SECRET</span><span class="p">,</span>
</span><span id="GetPixivToken-246"><a href="#GetPixivToken-246"><span class="linenos">246</span></a>                <span class="s2">&quot;grant_type&quot;</span><span class="p">:</span> <span class="s2">&quot;refresh_token&quot;</span><span class="p">,</span>
</span><span id="GetPixivToken-247"><a href="#GetPixivToken-247"><span class="linenos">247</span></a>                <span class="s2">&quot;include_policy&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span><span class="p">,</span>
</span><span id="GetPixivToken-248"><a href="#GetPixivToken-248"><span class="linenos">248</span></a>                <span class="s2">&quot;refresh_token&quot;</span><span class="p">:</span> <span class="n">refresh_token</span><span class="p">,</span>
</span><span id="GetPixivToken-249"><a href="#GetPixivToken-249"><span class="linenos">249</span></a>            <span class="p">},</span>
</span><span id="GetPixivToken-250"><a href="#GetPixivToken-250"><span class="linenos">250</span></a>            <span class="n">headers</span><span class="o">=</span><span class="p">{</span>
</span><span id="GetPixivToken-251"><a href="#GetPixivToken-251"><span class="linenos">251</span></a>                <span class="s2">&quot;user-agent&quot;</span><span class="p">:</span> <span class="n">USER_AGENT</span><span class="p">,</span>
</span><span id="GetPixivToken-252"><a href="#GetPixivToken-252"><span class="linenos">252</span></a>                <span class="s2">&quot;app-os-version&quot;</span><span class="p">:</span> <span class="s2">&quot;14.6&quot;</span><span class="p">,</span>
</span><span id="GetPixivToken-253"><a href="#GetPixivToken-253"><span class="linenos">253</span></a>                <span class="s2">&quot;app-os&quot;</span><span class="p">:</span> <span class="s2">&quot;ios&quot;</span><span class="p">,</span>
</span><span id="GetPixivToken-254"><a href="#GetPixivToken-254"><span class="linenos">254</span></a>            <span class="p">},</span>
</span><span id="GetPixivToken-255"><a href="#GetPixivToken-255"><span class="linenos">255</span></a>            <span class="n">proxies</span><span class="o">=</span><span class="n">PROXIES</span><span class="p">,</span>
</span><span id="GetPixivToken-256"><a href="#GetPixivToken-256"><span class="linenos">256</span></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">TIMEOUT</span><span class="p">,</span>
</span><span id="GetPixivToken-257"><a href="#GetPixivToken-257"><span class="linenos">257</span></a>        <span class="p">)</span>
</span><span id="GetPixivToken-258"><a href="#GetPixivToken-258"><span class="linenos">258</span></a>        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;LoginInfo&quot;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
</span><span id="GetPixivToken-259"><a href="#GetPixivToken-259"><span class="linenos">259</span></a>
</span><span id="GetPixivToken-260"><a href="#GetPixivToken-260"><span class="linenos">260</span></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">__fill_login_form</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="GetPixivToken-261"><a href="#GetPixivToken-261"><span class="linenos">261</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="GetPixivToken-262"><a href="#GetPixivToken-262"><span class="linenos">262</span></a>            <span class="k">return</span>
</span><span id="GetPixivToken-263"><a href="#GetPixivToken-263"><span class="linenos">263</span></a>
</span><span id="GetPixivToken-264"><a href="#GetPixivToken-264"><span class="linenos">264</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">:</span>
</span><span id="GetPixivToken-265"><a href="#GetPixivToken-265"><span class="linenos">265</span></a>            <span class="n">el</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">locator</span><span class="p">(</span><span class="s2">&quot;input[autocomplete^=&#39;username&#39;]&quot;</span><span class="p">)</span>
</span><span id="GetPixivToken-266"><a href="#GetPixivToken-266"><span class="linenos">266</span></a>            <span class="k">await</span> <span class="n">_slow_type</span><span class="p">(</span><span class="n">el</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">)</span>
</span><span id="GetPixivToken-267"><a href="#GetPixivToken-267"><span class="linenos">267</span></a>
</span><span id="GetPixivToken-268"><a href="#GetPixivToken-268"><span class="linenos">268</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">password</span><span class="p">:</span>
</span><span id="GetPixivToken-269"><a href="#GetPixivToken-269"><span class="linenos">269</span></a>            <span class="n">el</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">locator</span><span class="p">(</span><span class="s2">&quot;input[autocomplete^=&#39;current-password&#39;]&quot;</span><span class="p">)</span>
</span><span id="GetPixivToken-270"><a href="#GetPixivToken-270"><span class="linenos">270</span></a>            <span class="k">await</span> <span class="n">_slow_type</span><span class="p">(</span><span class="n">el</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">password</span><span class="p">)</span>
</span><span id="GetPixivToken-271"><a href="#GetPixivToken-271"><span class="linenos">271</span></a>
</span><span id="GetPixivToken-272"><a href="#GetPixivToken-272"><span class="linenos">272</span></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">__try_login</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="GetPixivToken-273"><a href="#GetPixivToken-273"><span class="linenos">273</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="GetPixivToken-274"><a href="#GetPixivToken-274"><span class="linenos">274</span></a>            <span class="k">return</span>
</span><span id="GetPixivToken-275"><a href="#GetPixivToken-275"><span class="linenos">275</span></a>
</span><span id="GetPixivToken-276"><a href="#GetPixivToken-276"><span class="linenos">276</span></a>        <span class="n">labels</span><span class="p">:</span> <span class="n">Final</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;Log In&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]</span>
</span><span id="GetPixivToken-277"><a href="#GetPixivToken-277"><span class="linenos">277</span></a>        <span class="n">label_conditions</span> <span class="o">=</span> <span class="s2">&quot; or &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;contains(text(), &#39;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">&#39;)&quot;</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">])</span>
</span><span id="GetPixivToken-278"><a href="#GetPixivToken-278"><span class="linenos">278</span></a>        <span class="n">el</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">locator</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;xpath=//button[@type=&#39;submit&#39;][</span><span class="si">{</span><span class="n">label_conditions</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
</span><span id="GetPixivToken-279"><a href="#GetPixivToken-279"><span class="linenos">279</span></a>        <span class="k">await</span> <span class="n">el</span><span class="o">.</span><span class="n">press</span><span class="p">(</span><span class="s2">&quot;Enter&quot;</span><span class="p">)</span>
</span><span id="GetPixivToken-280"><a href="#GetPixivToken-280"><span class="linenos">280</span></a>
</span><span id="GetPixivToken-281"><a href="#GetPixivToken-281"><span class="linenos">281</span></a>        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__wait_for_redirect</span><span class="p">()</span>
</span><span id="GetPixivToken-282"><a href="#GetPixivToken-282"><span class="linenos">282</span></a>
</span><span id="GetPixivToken-283"><a href="#GetPixivToken-283"><span class="linenos">283</span></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">__wait_for_redirect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="GetPixivToken-284"><a href="#GetPixivToken-284"><span class="linenos">284</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>  <span class="c1"># noqa: S101</span>
</span><span id="GetPixivToken-285"><a href="#GetPixivToken-285"><span class="linenos">285</span></a>
</span><span id="GetPixivToken-286"><a href="#GetPixivToken-286"><span class="linenos">286</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="GetPixivToken-287"><a href="#GetPixivToken-287"><span class="linenos">287</span></a>            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">wait_for_url</span><span class="p">(</span>
</span><span id="GetPixivToken-288"><a href="#GetPixivToken-288"><span class="linenos">288</span></a>                <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;^</span><span class="si">{</span><span class="n">re</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">REDIRECT_URI</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span> <span class="n">wait_until</span><span class="o">=</span><span class="s2">&quot;networkidle&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">60000</span>
</span><span id="GetPixivToken-289"><a href="#GetPixivToken-289"><span class="linenos">289</span></a>            <span class="p">)</span>
</span><span id="GetPixivToken-290"><a href="#GetPixivToken-290"><span class="linenos">290</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
</span><span id="GetPixivToken-291"><a href="#GetPixivToken-291"><span class="linenos">291</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="p">:</span>
</span><span id="GetPixivToken-292"><a href="#GetPixivToken-292"><span class="linenos">292</span></a>                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="GetPixivToken-293"><a href="#GetPixivToken-293"><span class="linenos">293</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Failed to login. Please check your information or proxy. (Maybe restricted by pixiv?)&quot;</span>
</span><span id="GetPixivToken-294"><a href="#GetPixivToken-294"><span class="linenos">294</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">err</span>
</span></pre></div>


            <div class="docstring"><p>GetPixivToken class for obtaining OAuth tokens from Pixiv.</p>

<p>This class uses Playwright to automate the login process and retrieve the OAuth token.
It supports both headless and non-headless modes for the browser.</p>
</div>


                            <div id="GetPixivToken.__init__" class="classattr">
                                        <input id="GetPixivToken.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">GetPixivToken</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">headless</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">username</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="GetPixivToken.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GetPixivToken.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GetPixivToken.__init__-53"><a href="#GetPixivToken.__init__-53"><span class="linenos">53</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="GetPixivToken.__init__-54"><a href="#GetPixivToken.__init__-54"><span class="linenos">54</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="GetPixivToken.__init__-55"><a href="#GetPixivToken.__init__-55"><span class="linenos">55</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="GetPixivToken.__init__-56"><a href="#GetPixivToken.__init__-56"><span class="linenos">56</span></a>        <span class="n">headless</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="GetPixivToken.__init__-57"><a href="#GetPixivToken.__init__-57"><span class="linenos">57</span></a>        <span class="n">username</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="GetPixivToken.__init__-58"><a href="#GetPixivToken.__init__-58"><span class="linenos">58</span></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="GetPixivToken.__init__-59"><a href="#GetPixivToken.__init__-59"><span class="linenos">59</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="GetPixivToken.__init__-60"><a href="#GetPixivToken.__init__-60"><span class="linenos">60</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the GetPixivToken class.</span>
</span><span id="GetPixivToken.__init__-61"><a href="#GetPixivToken.__init__-61"><span class="linenos">61</span></a>
</span><span id="GetPixivToken.__init__-62"><a href="#GetPixivToken.__init__-62"><span class="linenos">62</span></a><span class="sd">        Args:</span>
</span><span id="GetPixivToken.__init__-63"><a href="#GetPixivToken.__init__-63"><span class="linenos">63</span></a><span class="sd">            headless (bool | None): Whether to run the browser in headless mode. Defaults to False.</span>
</span><span id="GetPixivToken.__init__-64"><a href="#GetPixivToken.__init__-64"><span class="linenos">64</span></a><span class="sd">            username (str | None): The username for Pixiv login. Defaults to None.</span>
</span><span id="GetPixivToken.__init__-65"><a href="#GetPixivToken.__init__-65"><span class="linenos">65</span></a><span class="sd">            password (str | None): The password for Pixiv login. Defaults to None.</span>
</span><span id="GetPixivToken.__init__-66"><a href="#GetPixivToken.__init__-66"><span class="linenos">66</span></a>
</span><span id="GetPixivToken.__init__-67"><a href="#GetPixivToken.__init__-67"><span class="linenos">67</span></a><span class="sd">        Raises:</span>
</span><span id="GetPixivToken.__init__-68"><a href="#GetPixivToken.__init__-68"><span class="linenos">68</span></a><span class="sd">            ValueError: If headless mode is enabled but username or password is not provided.</span>
</span><span id="GetPixivToken.__init__-69"><a href="#GetPixivToken.__init__-69"><span class="linenos">69</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GetPixivToken.__init__-70"><a href="#GetPixivToken.__init__-70"><span class="linenos">70</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">headless</span> <span class="o">=</span> <span class="n">headless</span>
</span><span id="GetPixivToken.__init__-71"><a href="#GetPixivToken.__init__-71"><span class="linenos">71</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="n">username</span>
</span><span id="GetPixivToken.__init__-72"><a href="#GetPixivToken.__init__-72"><span class="linenos">72</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="n">password</span>
</span><span id="GetPixivToken.__init__-73"><a href="#GetPixivToken.__init__-73"><span class="linenos">73</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="p">:</span> <span class="n">Browser</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="GetPixivToken.__init__-74"><a href="#GetPixivToken.__init__-74"><span class="linenos">74</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">:</span> <span class="n">BrowserContext</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="GetPixivToken.__init__-75"><a href="#GetPixivToken.__init__-75"><span class="linenos">75</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="p">:</span> <span class="n">Page</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="GetPixivToken.__init__-76"><a href="#GetPixivToken.__init__-76"><span class="linenos">76</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the GetPixivToken class.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>headless (bool | None):</strong>  Whether to run the browser in headless mode. Defaults to False.</li>
<li><strong>username (str | None):</strong>  The username for Pixiv login. Defaults to None.</li>
<li><strong>password (str | None):</strong>  The password for Pixiv login. Defaults to None.</li>
</ul>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>ValueError:</strong>  If headless mode is enabled but username or password is not provided.</li>
</ul>
</div>


                            </div>
                            <div id="GetPixivToken.headless" class="classattr">
                                <div class="attr variable">
            <span class="name">headless</span>

        
    </div>
    <a class="headerlink" href="#GetPixivToken.headless"></a>
    
    

                            </div>
                            <div id="GetPixivToken.username" class="classattr">
                                <div class="attr variable">
            <span class="name">username</span>

        
    </div>
    <a class="headerlink" href="#GetPixivToken.username"></a>
    
    

                            </div>
                            <div id="GetPixivToken.password" class="classattr">
                                <div class="attr variable">
            <span class="name">password</span>

        
    </div>
    <a class="headerlink" href="#GetPixivToken.password"></a>
    
    

                            </div>
                            <div id="GetPixivToken.browser" class="classattr">
                                <div class="attr variable">
            <span class="name">browser</span><span class="annotation">: playwright.async_api._generated.Browser | None</span>

        
    </div>
    <a class="headerlink" href="#GetPixivToken.browser"></a>
    
    

                            </div>
                            <div id="GetPixivToken.context" class="classattr">
                                <div class="attr variable">
            <span class="name">context</span><span class="annotation">: playwright.async_api._generated.BrowserContext | None</span>

        
    </div>
    <a class="headerlink" href="#GetPixivToken.context"></a>
    
    

                            </div>
                            <div id="GetPixivToken.page" class="classattr">
                                <div class="attr variable">
            <span class="name">page</span><span class="annotation">: playwright.async_api._generated.Page | None</span>

        
    </div>
    <a class="headerlink" href="#GetPixivToken.page"></a>
    
    

                            </div>
                            <div id="GetPixivToken.code" class="classattr">
                                <div class="attr variable">
            <span class="name">code</span><span class="annotation">: str | None</span>

        
    </div>
    <a class="headerlink" href="#GetPixivToken.code"></a>
    
    

                            </div>
                            <div id="GetPixivToken.login" class="classattr">
                                        <input id="GetPixivToken.login-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">async def</span>
        <span class="name">login</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">headless</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">username</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#LoginInfo">LoginInfo</a></span>:</span></span>

                <label class="view-source-button" for="GetPixivToken.login-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GetPixivToken.login"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GetPixivToken.login-78"><a href="#GetPixivToken.login-78"><span class="linenos"> 78</span></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">login</span><span class="p">(</span>
</span><span id="GetPixivToken.login-79"><a href="#GetPixivToken.login-79"><span class="linenos"> 79</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="GetPixivToken.login-80"><a href="#GetPixivToken.login-80"><span class="linenos"> 80</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="GetPixivToken.login-81"><a href="#GetPixivToken.login-81"><span class="linenos"> 81</span></a>        <span class="n">headless</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="GetPixivToken.login-82"><a href="#GetPixivToken.login-82"><span class="linenos"> 82</span></a>        <span class="n">username</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="GetPixivToken.login-83"><a href="#GetPixivToken.login-83"><span class="linenos"> 83</span></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="GetPixivToken.login-84"><a href="#GetPixivToken.login-84"><span class="linenos"> 84</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LoginInfo</span><span class="p">:</span>
</span><span id="GetPixivToken.login-85"><a href="#GetPixivToken.login-85"><span class="linenos"> 85</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Login to Pixiv and obtain the OAuth token.</span>
</span><span id="GetPixivToken.login-86"><a href="#GetPixivToken.login-86"><span class="linenos"> 86</span></a>
</span><span id="GetPixivToken.login-87"><a href="#GetPixivToken.login-87"><span class="linenos"> 87</span></a><span class="sd">        This method uses Playwright to automate the login process and retrieve the OAuth token.</span>
</span><span id="GetPixivToken.login-88"><a href="#GetPixivToken.login-88"><span class="linenos"> 88</span></a>
</span><span id="GetPixivToken.login-89"><a href="#GetPixivToken.login-89"><span class="linenos"> 89</span></a><span class="sd">        Args:</span>
</span><span id="GetPixivToken.login-90"><a href="#GetPixivToken.login-90"><span class="linenos"> 90</span></a><span class="sd">            headless (bool | None): Whether to run the browser in headless mode. Defaults to None.</span>
</span><span id="GetPixivToken.login-91"><a href="#GetPixivToken.login-91"><span class="linenos"> 91</span></a><span class="sd">            username (str | None): The username for Pixiv login. Defaults to None.</span>
</span><span id="GetPixivToken.login-92"><a href="#GetPixivToken.login-92"><span class="linenos"> 92</span></a><span class="sd">            password (str | None): The password for Pixiv login. Defaults to None.</span>
</span><span id="GetPixivToken.login-93"><a href="#GetPixivToken.login-93"><span class="linenos"> 93</span></a>
</span><span id="GetPixivToken.login-94"><a href="#GetPixivToken.login-94"><span class="linenos"> 94</span></a><span class="sd">        Returns:</span>
</span><span id="GetPixivToken.login-95"><a href="#GetPixivToken.login-95"><span class="linenos"> 95</span></a><span class="sd">            LoginInfo: The login information containing the OAuth token and other details.</span>
</span><span id="GetPixivToken.login-96"><a href="#GetPixivToken.login-96"><span class="linenos"> 96</span></a>
</span><span id="GetPixivToken.login-97"><a href="#GetPixivToken.login-97"><span class="linenos"> 97</span></a><span class="sd">        Raises:</span>
</span><span id="GetPixivToken.login-98"><a href="#GetPixivToken.login-98"><span class="linenos"> 98</span></a><span class="sd">            ValueError: If headless mode is enabled but username or password is not provided.</span>
</span><span id="GetPixivToken.login-99"><a href="#GetPixivToken.login-99"><span class="linenos"> 99</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GetPixivToken.login-100"><a href="#GetPixivToken.login-100"><span class="linenos">100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__update_credentials</span><span class="p">(</span>
</span><span id="GetPixivToken.login-101"><a href="#GetPixivToken.login-101"><span class="linenos">101</span></a>            <span class="n">headless</span><span class="o">=</span><span class="n">headless</span><span class="p">,</span>
</span><span id="GetPixivToken.login-102"><a href="#GetPixivToken.login-102"><span class="linenos">102</span></a>            <span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span>
</span><span id="GetPixivToken.login-103"><a href="#GetPixivToken.login-103"><span class="linenos">103</span></a>            <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span>
</span><span id="GetPixivToken.login-104"><a href="#GetPixivToken.login-104"><span class="linenos">104</span></a>        <span class="p">)</span>
</span><span id="GetPixivToken.login-105"><a href="#GetPixivToken.login-105"><span class="linenos">105</span></a>        <span class="n">code_verifier</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__perform_browser_login</span><span class="p">()</span>
</span><span id="GetPixivToken.login-106"><a href="#GetPixivToken.login-106"><span class="linenos">106</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__exchange_code_for_token</span><span class="p">(</span><span class="n">code_verifier</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Login to Pixiv and obtain the OAuth token.</p>

<p>This method uses Playwright to automate the login process and retrieve the OAuth token.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>headless (bool | None):</strong>  Whether to run the browser in headless mode. Defaults to None.</li>
<li><strong>username (str | None):</strong>  The username for Pixiv login. Defaults to None.</li>
<li><strong>password (str | None):</strong>  The password for Pixiv login. Defaults to None.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>LoginInfo: The login information containing the OAuth token and other details.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>ValueError:</strong>  If headless mode is enabled but username or password is not provided.</li>
</ul>
</div>


                            </div>
                            <div id="GetPixivToken.refresh" class="classattr">
                                        <input id="GetPixivToken.refresh-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">refresh</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">refresh_token</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="n"><a href="#LoginInfo">LoginInfo</a></span>:</span></span>

                <label class="view-source-button" for="GetPixivToken.refresh-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GetPixivToken.refresh"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GetPixivToken.refresh-226"><a href="#GetPixivToken.refresh-226"><span class="linenos">226</span></a>    <span class="nd">@staticmethod</span>
</span><span id="GetPixivToken.refresh-227"><a href="#GetPixivToken.refresh-227"><span class="linenos">227</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">refresh</span><span class="p">(</span><span class="n">refresh_token</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LoginInfo</span><span class="p">:</span>
</span><span id="GetPixivToken.refresh-228"><a href="#GetPixivToken.refresh-228"><span class="linenos">228</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Refresh the OAuth token using the refresh token.</span>
</span><span id="GetPixivToken.refresh-229"><a href="#GetPixivToken.refresh-229"><span class="linenos">229</span></a>
</span><span id="GetPixivToken.refresh-230"><a href="#GetPixivToken.refresh-230"><span class="linenos">230</span></a><span class="sd">        This method sends a request to the Pixiv API to refresh the token.</span>
</span><span id="GetPixivToken.refresh-231"><a href="#GetPixivToken.refresh-231"><span class="linenos">231</span></a>
</span><span id="GetPixivToken.refresh-232"><a href="#GetPixivToken.refresh-232"><span class="linenos">232</span></a><span class="sd">        Args:</span>
</span><span id="GetPixivToken.refresh-233"><a href="#GetPixivToken.refresh-233"><span class="linenos">233</span></a><span class="sd">            refresh_token (str): The refresh token obtained during login.</span>
</span><span id="GetPixivToken.refresh-234"><a href="#GetPixivToken.refresh-234"><span class="linenos">234</span></a>
</span><span id="GetPixivToken.refresh-235"><a href="#GetPixivToken.refresh-235"><span class="linenos">235</span></a><span class="sd">        Returns:</span>
</span><span id="GetPixivToken.refresh-236"><a href="#GetPixivToken.refresh-236"><span class="linenos">236</span></a><span class="sd">            LoginInfo: The login information containing the new OAuth token and other details.</span>
</span><span id="GetPixivToken.refresh-237"><a href="#GetPixivToken.refresh-237"><span class="linenos">237</span></a>
</span><span id="GetPixivToken.refresh-238"><a href="#GetPixivToken.refresh-238"><span class="linenos">238</span></a><span class="sd">        Raises:</span>
</span><span id="GetPixivToken.refresh-239"><a href="#GetPixivToken.refresh-239"><span class="linenos">239</span></a><span class="sd">            ValueError: If the refresh token is not provided.</span>
</span><span id="GetPixivToken.refresh-240"><a href="#GetPixivToken.refresh-240"><span class="linenos">240</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GetPixivToken.refresh-241"><a href="#GetPixivToken.refresh-241"><span class="linenos">241</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span><span id="GetPixivToken.refresh-242"><a href="#GetPixivToken.refresh-242"><span class="linenos">242</span></a>            <span class="n">AUTH_TOKEN_URL</span><span class="p">,</span>
</span><span id="GetPixivToken.refresh-243"><a href="#GetPixivToken.refresh-243"><span class="linenos">243</span></a>            <span class="n">data</span><span class="o">=</span><span class="p">{</span>
</span><span id="GetPixivToken.refresh-244"><a href="#GetPixivToken.refresh-244"><span class="linenos">244</span></a>                <span class="s2">&quot;client_id&quot;</span><span class="p">:</span> <span class="n">CLIENT_ID</span><span class="p">,</span>
</span><span id="GetPixivToken.refresh-245"><a href="#GetPixivToken.refresh-245"><span class="linenos">245</span></a>                <span class="s2">&quot;client_secret&quot;</span><span class="p">:</span> <span class="n">CLIENT_SECRET</span><span class="p">,</span>
</span><span id="GetPixivToken.refresh-246"><a href="#GetPixivToken.refresh-246"><span class="linenos">246</span></a>                <span class="s2">&quot;grant_type&quot;</span><span class="p">:</span> <span class="s2">&quot;refresh_token&quot;</span><span class="p">,</span>
</span><span id="GetPixivToken.refresh-247"><a href="#GetPixivToken.refresh-247"><span class="linenos">247</span></a>                <span class="s2">&quot;include_policy&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span><span class="p">,</span>
</span><span id="GetPixivToken.refresh-248"><a href="#GetPixivToken.refresh-248"><span class="linenos">248</span></a>                <span class="s2">&quot;refresh_token&quot;</span><span class="p">:</span> <span class="n">refresh_token</span><span class="p">,</span>
</span><span id="GetPixivToken.refresh-249"><a href="#GetPixivToken.refresh-249"><span class="linenos">249</span></a>            <span class="p">},</span>
</span><span id="GetPixivToken.refresh-250"><a href="#GetPixivToken.refresh-250"><span class="linenos">250</span></a>            <span class="n">headers</span><span class="o">=</span><span class="p">{</span>
</span><span id="GetPixivToken.refresh-251"><a href="#GetPixivToken.refresh-251"><span class="linenos">251</span></a>                <span class="s2">&quot;user-agent&quot;</span><span class="p">:</span> <span class="n">USER_AGENT</span><span class="p">,</span>
</span><span id="GetPixivToken.refresh-252"><a href="#GetPixivToken.refresh-252"><span class="linenos">252</span></a>                <span class="s2">&quot;app-os-version&quot;</span><span class="p">:</span> <span class="s2">&quot;14.6&quot;</span><span class="p">,</span>
</span><span id="GetPixivToken.refresh-253"><a href="#GetPixivToken.refresh-253"><span class="linenos">253</span></a>                <span class="s2">&quot;app-os&quot;</span><span class="p">:</span> <span class="s2">&quot;ios&quot;</span><span class="p">,</span>
</span><span id="GetPixivToken.refresh-254"><a href="#GetPixivToken.refresh-254"><span class="linenos">254</span></a>            <span class="p">},</span>
</span><span id="GetPixivToken.refresh-255"><a href="#GetPixivToken.refresh-255"><span class="linenos">255</span></a>            <span class="n">proxies</span><span class="o">=</span><span class="n">PROXIES</span><span class="p">,</span>
</span><span id="GetPixivToken.refresh-256"><a href="#GetPixivToken.refresh-256"><span class="linenos">256</span></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">TIMEOUT</span><span class="p">,</span>
</span><span id="GetPixivToken.refresh-257"><a href="#GetPixivToken.refresh-257"><span class="linenos">257</span></a>        <span class="p">)</span>
</span><span id="GetPixivToken.refresh-258"><a href="#GetPixivToken.refresh-258"><span class="linenos">258</span></a>        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;LoginInfo&quot;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
</span></pre></div>


            <div class="docstring"><p>Refresh the OAuth token using the refresh token.</p>

<p>This method sends a request to the Pixiv API to refresh the token.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>refresh_token (str):</strong>  The refresh token obtained during login.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>LoginInfo: The login information containing the new OAuth token and other details.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>ValueError:</strong>  If the refresh token is not provided.</li>
</ul>
</div>


                            </div>
                </section>
                <section id="LoginCred">
                            <input id="LoginCred-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">LoginCred</span><wbr>(<span class="base">typing.TypedDict</span>):

                <label class="view-source-button" for="LoginCred-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LoginCred"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LoginCred-11"><a href="#LoginCred-11"><span class="linenos">11</span></a><span class="k">class</span><span class="w"> </span><span class="nc">LoginCred</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
</span><span id="LoginCred-12"><a href="#LoginCred-12"><span class="linenos">12</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Login credentials for Pixiv.&quot;&quot;&quot;</span>
</span><span id="LoginCred-13"><a href="#LoginCred-13"><span class="linenos">13</span></a>
</span><span id="LoginCred-14"><a href="#LoginCred-14"><span class="linenos">14</span></a>    <span class="n">pixiv_id</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="LoginCred-15"><a href="#LoginCred-15"><span class="linenos">15</span></a>    <span class="n">password</span><span class="p">:</span> <span class="nb">str</span>
</span></pre></div>


            <div class="docstring"><p>Login credentials for Pixiv.</p>
</div>


                            <div id="LoginCred.pixiv_id" class="classattr">
                                <div class="attr variable">
            <span class="name">pixiv_id</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#LoginCred.pixiv_id"></a>
    
    

                            </div>
                            <div id="LoginCred.password" class="classattr">
                                <div class="attr variable">
            <span class="name">password</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#LoginCred.password"></a>
    
    

                            </div>
                </section>
                <section id="LoginInfo">
                            <input id="LoginInfo-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">LoginInfo</span><wbr>(<span class="base">typing.TypedDict</span>):

                <label class="view-source-button" for="LoginInfo-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LoginInfo"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LoginInfo-51"><a href="#LoginInfo-51"><span class="linenos">51</span></a><span class="k">class</span><span class="w"> </span><span class="nc">LoginInfo</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
</span><span id="LoginInfo-52"><a href="#LoginInfo-52"><span class="linenos">52</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Login information for Pixiv.&quot;&quot;&quot;</span>
</span><span id="LoginInfo-53"><a href="#LoginInfo-53"><span class="linenos">53</span></a>
</span><span id="LoginInfo-54"><a href="#LoginInfo-54"><span class="linenos">54</span></a>    <span class="n">access_token</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="LoginInfo-55"><a href="#LoginInfo-55"><span class="linenos">55</span></a>    <span class="n">expires_in</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="LoginInfo-56"><a href="#LoginInfo-56"><span class="linenos">56</span></a>    <span class="n">token_type</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="LoginInfo-57"><a href="#LoginInfo-57"><span class="linenos">57</span></a>    <span class="n">scope</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="LoginInfo-58"><a href="#LoginInfo-58"><span class="linenos">58</span></a>    <span class="n">refresh_token</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="LoginInfo-59"><a href="#LoginInfo-59"><span class="linenos">59</span></a>    <span class="n">user</span><span class="p">:</span> <span class="n">LoginUserInfo</span>
</span><span id="LoginInfo-60"><a href="#LoginInfo-60"><span class="linenos">60</span></a>    <span class="n">response</span><span class="p">:</span> <span class="n">OAuthAPIResponse</span>
</span></pre></div>


            <div class="docstring"><p>Login information for Pixiv.</p>
</div>


                            <div id="LoginInfo.access_token" class="classattr">
                                <div class="attr variable">
            <span class="name">access_token</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#LoginInfo.access_token"></a>
    
    

                            </div>
                            <div id="LoginInfo.expires_in" class="classattr">
                                <div class="attr variable">
            <span class="name">expires_in</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#LoginInfo.expires_in"></a>
    
    

                            </div>
                            <div id="LoginInfo.token_type" class="classattr">
                                <div class="attr variable">
            <span class="name">token_type</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#LoginInfo.token_type"></a>
    
    

                            </div>
                            <div id="LoginInfo.scope" class="classattr">
                                <div class="attr variable">
            <span class="name">scope</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#LoginInfo.scope"></a>
    
    

                            </div>
                            <div id="LoginInfo.refresh_token" class="classattr">
                                <div class="attr variable">
            <span class="name">refresh_token</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#LoginInfo.refresh_token"></a>
    
    

                            </div>
                            <div id="LoginInfo.user" class="classattr">
                                <div class="attr variable">
            <span class="name">user</span><span class="annotation">: <a href="#LoginUserInfo">LoginUserInfo</a></span>

        
    </div>
    <a class="headerlink" href="#LoginInfo.user"></a>
    
    

                            </div>
                            <div id="LoginInfo.response" class="classattr">
                                <div class="attr variable">
            <span class="name">response</span><span class="annotation">: <a href="#OAuthAPIResponse">OAuthAPIResponse</a></span>

        
    </div>
    <a class="headerlink" href="#LoginInfo.response"></a>
    
    

                            </div>
                </section>
                <section id="LoginUserInfo">
                            <input id="LoginUserInfo-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">LoginUserInfo</span><wbr>(<span class="base">typing.TypedDict</span>):

                <label class="view-source-button" for="LoginUserInfo-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LoginUserInfo"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LoginUserInfo-26"><a href="#LoginUserInfo-26"><span class="linenos">26</span></a><span class="k">class</span><span class="w"> </span><span class="nc">LoginUserInfo</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
</span><span id="LoginUserInfo-27"><a href="#LoginUserInfo-27"><span class="linenos">27</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Login user information for Pixiv.&quot;&quot;&quot;</span>
</span><span id="LoginUserInfo-28"><a href="#LoginUserInfo-28"><span class="linenos">28</span></a>
</span><span id="LoginUserInfo-29"><a href="#LoginUserInfo-29"><span class="linenos">29</span></a>    <span class="n">profile_image_urls</span><span class="p">:</span> <span class="n">ProfileURIs</span>
</span><span id="LoginUserInfo-30"><a href="#LoginUserInfo-30"><span class="linenos">30</span></a>    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="LoginUserInfo-31"><a href="#LoginUserInfo-31"><span class="linenos">31</span></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="LoginUserInfo-32"><a href="#LoginUserInfo-32"><span class="linenos">32</span></a>    <span class="n">account</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="LoginUserInfo-33"><a href="#LoginUserInfo-33"><span class="linenos">33</span></a>    <span class="n">mail_address</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="LoginUserInfo-34"><a href="#LoginUserInfo-34"><span class="linenos">34</span></a>    <span class="n">is_premium</span><span class="p">:</span> <span class="nb">bool</span>
</span><span id="LoginUserInfo-35"><a href="#LoginUserInfo-35"><span class="linenos">35</span></a>    <span class="n">x_restrict</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="LoginUserInfo-36"><a href="#LoginUserInfo-36"><span class="linenos">36</span></a>    <span class="n">is_mail_authorized</span><span class="p">:</span> <span class="nb">bool</span>
</span><span id="LoginUserInfo-37"><a href="#LoginUserInfo-37"><span class="linenos">37</span></a>    <span class="n">require_policy_agreement</span><span class="p">:</span> <span class="nb">bool</span>
</span></pre></div>


            <div class="docstring"><p>Login user information for Pixiv.</p>
</div>


                            <div id="LoginUserInfo.profile_image_urls" class="classattr">
                                <div class="attr variable">
            <span class="name">profile_image_urls</span><span class="annotation">: <a href="#ProfileURIs">ProfileURIs</a></span>

        
    </div>
    <a class="headerlink" href="#LoginUserInfo.profile_image_urls"></a>
    
    

                            </div>
                            <div id="LoginUserInfo.id" class="classattr">
                                <div class="attr variable">
            <span class="name">id</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#LoginUserInfo.id"></a>
    
    

                            </div>
                            <div id="LoginUserInfo.name" class="classattr">
                                <div class="attr variable">
            <span class="name">name</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#LoginUserInfo.name"></a>
    
    

                            </div>
                            <div id="LoginUserInfo.account" class="classattr">
                                <div class="attr variable">
            <span class="name">account</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#LoginUserInfo.account"></a>
    
    

                            </div>
                            <div id="LoginUserInfo.mail_address" class="classattr">
                                <div class="attr variable">
            <span class="name">mail_address</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#LoginUserInfo.mail_address"></a>
    
    

                            </div>
                            <div id="LoginUserInfo.is_premium" class="classattr">
                                <div class="attr variable">
            <span class="name">is_premium</span><span class="annotation">: bool</span>

        
    </div>
    <a class="headerlink" href="#LoginUserInfo.is_premium"></a>
    
    

                            </div>
                            <div id="LoginUserInfo.x_restrict" class="classattr">
                                <div class="attr variable">
            <span class="name">x_restrict</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#LoginUserInfo.x_restrict"></a>
    
    

                            </div>
                            <div id="LoginUserInfo.is_mail_authorized" class="classattr">
                                <div class="attr variable">
            <span class="name">is_mail_authorized</span><span class="annotation">: bool</span>

        
    </div>
    <a class="headerlink" href="#LoginUserInfo.is_mail_authorized"></a>
    
    

                            </div>
                            <div id="LoginUserInfo.require_policy_agreement" class="classattr">
                                <div class="attr variable">
            <span class="name">require_policy_agreement</span><span class="annotation">: bool</span>

        
    </div>
    <a class="headerlink" href="#LoginUserInfo.require_policy_agreement"></a>
    
    

                            </div>
                </section>
                <section id="OAuthAPIResponse">
                            <input id="OAuthAPIResponse-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">OAuthAPIResponse</span><wbr>(<span class="base">typing.TypedDict</span>):

                <label class="view-source-button" for="OAuthAPIResponse-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#OAuthAPIResponse"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="OAuthAPIResponse-40"><a href="#OAuthAPIResponse-40"><span class="linenos">40</span></a><span class="k">class</span><span class="w"> </span><span class="nc">OAuthAPIResponse</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
</span><span id="OAuthAPIResponse-41"><a href="#OAuthAPIResponse-41"><span class="linenos">41</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;OAuth API response for Pixiv login.&quot;&quot;&quot;</span>
</span><span id="OAuthAPIResponse-42"><a href="#OAuthAPIResponse-42"><span class="linenos">42</span></a>
</span><span id="OAuthAPIResponse-43"><a href="#OAuthAPIResponse-43"><span class="linenos">43</span></a>    <span class="n">access_token</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="OAuthAPIResponse-44"><a href="#OAuthAPIResponse-44"><span class="linenos">44</span></a>    <span class="n">expires_in</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="OAuthAPIResponse-45"><a href="#OAuthAPIResponse-45"><span class="linenos">45</span></a>    <span class="n">token_type</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="OAuthAPIResponse-46"><a href="#OAuthAPIResponse-46"><span class="linenos">46</span></a>    <span class="n">scope</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="OAuthAPIResponse-47"><a href="#OAuthAPIResponse-47"><span class="linenos">47</span></a>    <span class="n">refresh_token</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="OAuthAPIResponse-48"><a href="#OAuthAPIResponse-48"><span class="linenos">48</span></a>    <span class="n">user</span><span class="p">:</span> <span class="n">LoginUserInfo</span>
</span></pre></div>


            <div class="docstring"><p>OAuth API response for Pixiv login.</p>
</div>


                            <div id="OAuthAPIResponse.access_token" class="classattr">
                                <div class="attr variable">
            <span class="name">access_token</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#OAuthAPIResponse.access_token"></a>
    
    

                            </div>
                            <div id="OAuthAPIResponse.expires_in" class="classattr">
                                <div class="attr variable">
            <span class="name">expires_in</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#OAuthAPIResponse.expires_in"></a>
    
    

                            </div>
                            <div id="OAuthAPIResponse.token_type" class="classattr">
                                <div class="attr variable">
            <span class="name">token_type</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#OAuthAPIResponse.token_type"></a>
    
    

                            </div>
                            <div id="OAuthAPIResponse.scope" class="classattr">
                                <div class="attr variable">
            <span class="name">scope</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#OAuthAPIResponse.scope"></a>
    
    

                            </div>
                            <div id="OAuthAPIResponse.refresh_token" class="classattr">
                                <div class="attr variable">
            <span class="name">refresh_token</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#OAuthAPIResponse.refresh_token"></a>
    
    

                            </div>
                            <div id="OAuthAPIResponse.user" class="classattr">
                                <div class="attr variable">
            <span class="name">user</span><span class="annotation">: <a href="#LoginUserInfo">LoginUserInfo</a></span>

        
    </div>
    <a class="headerlink" href="#OAuthAPIResponse.user"></a>
    
    

                            </div>
                </section>
                <section id="PixivAuth">
                            <input id="PixivAuth-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PixivAuth</span>:

                <label class="view-source-button" for="PixivAuth-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PixivAuth"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PixivAuth-23"><a href="#PixivAuth-23"><span class="linenos"> 23</span></a><span class="k">class</span><span class="w"> </span><span class="nc">PixivAuth</span><span class="p">:</span>
</span><span id="PixivAuth-24"><a href="#PixivAuth-24"><span class="linenos"> 24</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Pixiv Authentication class.&quot;&quot;&quot;</span>
</span><span id="PixivAuth-25"><a href="#PixivAuth-25"><span class="linenos"> 25</span></a>
</span><span id="PixivAuth-26"><a href="#PixivAuth-26"><span class="linenos"> 26</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auth_json_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;client.json&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PixivAuth-27"><a href="#PixivAuth-27"><span class="linenos"> 27</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the PixivAuth class.</span>
</span><span id="PixivAuth-28"><a href="#PixivAuth-28"><span class="linenos"> 28</span></a>
</span><span id="PixivAuth-29"><a href="#PixivAuth-29"><span class="linenos"> 29</span></a><span class="sd">        Args:</span>
</span><span id="PixivAuth-30"><a href="#PixivAuth-30"><span class="linenos"> 30</span></a><span class="sd">            auth_json_path (str): Path to the JSON file containing client credentials.</span>
</span><span id="PixivAuth-31"><a href="#PixivAuth-31"><span class="linenos"> 31</span></a><span class="sd">                Defaults to &quot;client.json&quot;.</span>
</span><span id="PixivAuth-32"><a href="#PixivAuth-32"><span class="linenos"> 32</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PixivAuth-33"><a href="#PixivAuth-33"><span class="linenos"> 33</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">auth_json_path</span> <span class="o">=</span> <span class="n">auth_json_path</span>
</span><span id="PixivAuth-34"><a href="#PixivAuth-34"><span class="linenos"> 34</span></a>
</span><span id="PixivAuth-35"><a href="#PixivAuth-35"><span class="linenos"> 35</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">auth</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">AppPixivAPI</span><span class="p">,</span> <span class="n">LoginInfo</span><span class="p">]:</span>
</span><span id="PixivAuth-36"><a href="#PixivAuth-36"><span class="linenos"> 36</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Authenticate the user with Pixiv.</span>
</span><span id="PixivAuth-37"><a href="#PixivAuth-37"><span class="linenos"> 37</span></a>
</span><span id="PixivAuth-38"><a href="#PixivAuth-38"><span class="linenos"> 38</span></a><span class="sd">        This method attempts to log in to Pixiv using the provided credentials.</span>
</span><span id="PixivAuth-39"><a href="#PixivAuth-39"><span class="linenos"> 39</span></a><span class="sd">        It first checks for existing credentials in a JSON file. If the credentials</span>
</span><span id="PixivAuth-40"><a href="#PixivAuth-40"><span class="linenos"> 40</span></a><span class="sd">        are not found or if the login fails, it prompts the user for their ID and</span>
</span><span id="PixivAuth-41"><a href="#PixivAuth-41"><span class="linenos"> 41</span></a><span class="sd">        password. The method will retry the login process up to three times before</span>
</span><span id="PixivAuth-42"><a href="#PixivAuth-42"><span class="linenos"> 42</span></a><span class="sd">        raising a PixivLoginFailed exception.</span>
</span><span id="PixivAuth-43"><a href="#PixivAuth-43"><span class="linenos"> 43</span></a>
</span><span id="PixivAuth-44"><a href="#PixivAuth-44"><span class="linenos"> 44</span></a><span class="sd">        Returns:</span>
</span><span id="PixivAuth-45"><a href="#PixivAuth-45"><span class="linenos"> 45</span></a><span class="sd">            tuple[AppPixivAPI, LoginInfo]: A tuple containing the authenticated</span>
</span><span id="PixivAuth-46"><a href="#PixivAuth-46"><span class="linenos"> 46</span></a><span class="sd">                AppPixivAPI instance and the login information.</span>
</span><span id="PixivAuth-47"><a href="#PixivAuth-47"><span class="linenos"> 47</span></a>
</span><span id="PixivAuth-48"><a href="#PixivAuth-48"><span class="linenos"> 48</span></a><span class="sd">        Raises:</span>
</span><span id="PixivAuth-49"><a href="#PixivAuth-49"><span class="linenos"> 49</span></a><span class="sd">            PixivLoginFailed: If the login process fails after three attempts.</span>
</span><span id="PixivAuth-50"><a href="#PixivAuth-50"><span class="linenos"> 50</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PixivAuth-51"><a href="#PixivAuth-51"><span class="linenos"> 51</span></a>        <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="PixivAuth-52"><a href="#PixivAuth-52"><span class="linenos"> 52</span></a>        <span class="k">while</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>  <span class="c1"># noqa: PLR2004</span>
</span><span id="PixivAuth-53"><a href="#PixivAuth-53"><span class="linenos"> 53</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="PixivAuth-54"><a href="#PixivAuth-54"><span class="linenos"> 54</span></a>                <span class="n">aapi</span><span class="p">,</span> <span class="n">login_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__auth</span><span class="p">(</span><span class="n">cnt</span><span class="p">)</span>
</span><span id="PixivAuth-55"><a href="#PixivAuth-55"><span class="linenos"> 55</span></a>            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">UnboundLocalError</span><span class="p">):</span>
</span><span id="PixivAuth-56"><a href="#PixivAuth-56"><span class="linenos"> 56</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[?25h[!]: Failed to login. Check your ID or PW.&quot;</span><span class="p">)</span>
</span><span id="PixivAuth-57"><a href="#PixivAuth-57"><span class="linenos"> 57</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PixivAuth-58"><a href="#PixivAuth-58"><span class="linenos"> 58</span></a>                <span class="k">return</span> <span class="n">aapi</span><span class="p">,</span> <span class="n">login_info</span>
</span><span id="PixivAuth-59"><a href="#PixivAuth-59"><span class="linenos"> 59</span></a>            <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="PixivAuth-60"><a href="#PixivAuth-60"><span class="linenos"> 60</span></a>
</span><span id="PixivAuth-61"><a href="#PixivAuth-61"><span class="linenos"> 61</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[!]: The number of login attempts has been exceeded.&quot;</span><span class="p">)</span>
</span><span id="PixivAuth-62"><a href="#PixivAuth-62"><span class="linenos"> 62</span></a>        <span class="k">raise</span> <span class="n">PixivLoginFailedError</span>
</span><span id="PixivAuth-63"><a href="#PixivAuth-63"><span class="linenos"> 63</span></a>
</span><span id="PixivAuth-64"><a href="#PixivAuth-64"><span class="linenos"> 64</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__auth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cnt</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">AppPixivAPI</span><span class="p">,</span> <span class="n">LoginInfo</span><span class="p">]:</span>
</span><span id="PixivAuth-65"><a href="#PixivAuth-65"><span class="linenos"> 65</span></a>        <span class="n">aapi</span><span class="p">:</span> <span class="n">AppPixivAPI</span> <span class="o">=</span> <span class="n">AppPixivAPI</span><span class="p">()</span>
</span><span id="PixivAuth-66"><a href="#PixivAuth-66"><span class="linenos"> 66</span></a>        <span class="n">login_cred</span><span class="p">:</span> <span class="n">LoginCred</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_client_cred</span><span class="p">()</span>
</span><span id="PixivAuth-67"><a href="#PixivAuth-67"><span class="linenos"> 67</span></a>
</span><span id="PixivAuth-68"><a href="#PixivAuth-68"><span class="linenos"> 68</span></a>        <span class="k">if</span> <span class="n">login_cred</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">cnt</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PixivAuth-69"><a href="#PixivAuth-69"><span class="linenos"> 69</span></a>            <span class="n">ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_refresh_token</span><span class="p">(</span><span class="n">login_cred</span><span class="p">[</span><span class="s2">&quot;pixiv_id&quot;</span><span class="p">],</span> <span class="n">login_cred</span><span class="p">[</span><span class="s2">&quot;password&quot;</span><span class="p">])</span>
</span><span id="PixivAuth-70"><a href="#PixivAuth-70"><span class="linenos"> 70</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[?25l[+]: Login...&quot;</span><span class="p">)</span>
</span><span id="PixivAuth-71"><a href="#PixivAuth-71"><span class="linenos"> 71</span></a>            <span class="n">login_info</span> <span class="o">=</span> <span class="n">aapi</span><span class="o">.</span><span class="n">auth</span><span class="p">(</span><span class="n">refresh_token</span><span class="o">=</span><span class="n">ref</span><span class="p">)</span>
</span><span id="PixivAuth-72"><a href="#PixivAuth-72"><span class="linenos"> 72</span></a>        <span class="k">elif</span> <span class="n">login_cred</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">cnt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PixivAuth-73"><a href="#PixivAuth-73"><span class="linenos"> 73</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[+]: ID is mail address, username, or account name.&quot;</span><span class="p">)</span>
</span><span id="PixivAuth-74"><a href="#PixivAuth-74"><span class="linenos"> 74</span></a>            <span class="n">stdin_login</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PixivAuth-75"><a href="#PixivAuth-75"><span class="linenos"> 75</span></a>                <span class="n">pwinput</span><span class="o">.</span><span class="n">pwinput</span><span class="p">(</span><span class="n">prompt</span><span class="o">=</span><span class="s2">&quot;[?]: ID: &quot;</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">),</span>
</span><span id="PixivAuth-76"><a href="#PixivAuth-76"><span class="linenos"> 76</span></a>                <span class="n">pwinput</span><span class="o">.</span><span class="n">pwinput</span><span class="p">(</span><span class="n">prompt</span><span class="o">=</span><span class="s2">&quot;[?]: PW: &quot;</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">),</span>
</span><span id="PixivAuth-77"><a href="#PixivAuth-77"><span class="linenos"> 77</span></a>            <span class="p">)</span>
</span><span id="PixivAuth-78"><a href="#PixivAuth-78"><span class="linenos"> 78</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[?25l[+]: Login...&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PixivAuth-79"><a href="#PixivAuth-79"><span class="linenos"> 79</span></a>            <span class="n">ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_refresh_token</span><span class="p">(</span><span class="n">stdin_login</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stdin_login</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="PixivAuth-80"><a href="#PixivAuth-80"><span class="linenos"> 80</span></a>            <span class="n">login_info</span> <span class="o">=</span> <span class="n">aapi</span><span class="o">.</span><span class="n">auth</span><span class="p">(</span><span class="n">refresh_token</span><span class="o">=</span><span class="n">ref</span><span class="p">)</span>
</span><span id="PixivAuth-81"><a href="#PixivAuth-81"><span class="linenos"> 81</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\033</span><span class="s2">[K[+]: Login...OK!</span><span class="se">\x1b</span><span class="s2">[?25h&quot;</span><span class="p">)</span>
</span><span id="PixivAuth-82"><a href="#PixivAuth-82"><span class="linenos"> 82</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PixivAuth-83"><a href="#PixivAuth-83"><span class="linenos"> 83</span></a>            <span class="k">raise</span> <span class="n">PixivLoginFailedError</span>
</span><span id="PixivAuth-84"><a href="#PixivAuth-84"><span class="linenos"> 84</span></a>
</span><span id="PixivAuth-85"><a href="#PixivAuth-85"><span class="linenos"> 85</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">aapi</span><span class="p">,</span> <span class="n">login_info</span><span class="p">)</span>
</span><span id="PixivAuth-86"><a href="#PixivAuth-86"><span class="linenos"> 86</span></a>
</span><span id="PixivAuth-87"><a href="#PixivAuth-87"><span class="linenos"> 87</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PixivAuth-88"><a href="#PixivAuth-88"><span class="linenos"> 88</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_refresh_token</span><span class="p">(</span><span class="n">pixiv_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pixiv_pass</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="PixivAuth-89"><a href="#PixivAuth-89"><span class="linenos"> 89</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the refresh token for the given Pixiv ID and password.</span>
</span><span id="PixivAuth-90"><a href="#PixivAuth-90"><span class="linenos"> 90</span></a>
</span><span id="PixivAuth-91"><a href="#PixivAuth-91"><span class="linenos"> 91</span></a><span class="sd">        This method uses the GetPixivToken class to perform the login and</span>
</span><span id="PixivAuth-92"><a href="#PixivAuth-92"><span class="linenos"> 92</span></a><span class="sd">        retrieve the refresh token.</span>
</span><span id="PixivAuth-93"><a href="#PixivAuth-93"><span class="linenos"> 93</span></a>
</span><span id="PixivAuth-94"><a href="#PixivAuth-94"><span class="linenos"> 94</span></a><span class="sd">        Args:</span>
</span><span id="PixivAuth-95"><a href="#PixivAuth-95"><span class="linenos"> 95</span></a><span class="sd">            pixiv_id (str): The Pixiv ID (email address, username, or account name).</span>
</span><span id="PixivAuth-96"><a href="#PixivAuth-96"><span class="linenos"> 96</span></a><span class="sd">            pixiv_pass (str): The password for the Pixiv account.</span>
</span><span id="PixivAuth-97"><a href="#PixivAuth-97"><span class="linenos"> 97</span></a>
</span><span id="PixivAuth-98"><a href="#PixivAuth-98"><span class="linenos"> 98</span></a><span class="sd">        Returns:</span>
</span><span id="PixivAuth-99"><a href="#PixivAuth-99"><span class="linenos"> 99</span></a><span class="sd">            str: The refresh token for the Pixiv account.</span>
</span><span id="PixivAuth-100"><a href="#PixivAuth-100"><span class="linenos">100</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PixivAuth-101"><a href="#PixivAuth-101"><span class="linenos">101</span></a>        <span class="n">g</span> <span class="o">=</span> <span class="n">GetPixivToken</span><span class="p">(</span><span class="n">headless</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="n">pixiv_id</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">pixiv_pass</span><span class="p">)</span>
</span><span id="PixivAuth-102"><a href="#PixivAuth-102"><span class="linenos">102</span></a>        <span class="k">return</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">login</span><span class="p">())[</span><span class="s2">&quot;refresh_token&quot;</span><span class="p">]</span>
</span><span id="PixivAuth-103"><a href="#PixivAuth-103"><span class="linenos">103</span></a>
</span><span id="PixivAuth-104"><a href="#PixivAuth-104"><span class="linenos">104</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">read_client_cred</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LoginCred</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PixivAuth-105"><a href="#PixivAuth-105"><span class="linenos">105</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Read the client credentials from the JSON file.</span>
</span><span id="PixivAuth-106"><a href="#PixivAuth-106"><span class="linenos">106</span></a>
</span><span id="PixivAuth-107"><a href="#PixivAuth-107"><span class="linenos">107</span></a><span class="sd">        This method checks if the JSON file containing the client credentials</span>
</span><span id="PixivAuth-108"><a href="#PixivAuth-108"><span class="linenos">108</span></a><span class="sd">        exists and attempts to load the credentials. If the credentials are</span>
</span><span id="PixivAuth-109"><a href="#PixivAuth-109"><span class="linenos">109</span></a><span class="sd">        successfully loaded and contain the required keys, they are returned</span>
</span><span id="PixivAuth-110"><a href="#PixivAuth-110"><span class="linenos">110</span></a><span class="sd">        as a LoginCred object. If the file does not exist or the credentials</span>
</span><span id="PixivAuth-111"><a href="#PixivAuth-111"><span class="linenos">111</span></a><span class="sd">        are invalid, None is returned.</span>
</span><span id="PixivAuth-112"><a href="#PixivAuth-112"><span class="linenos">112</span></a>
</span><span id="PixivAuth-113"><a href="#PixivAuth-113"><span class="linenos">113</span></a><span class="sd">        Returns:</span>
</span><span id="PixivAuth-114"><a href="#PixivAuth-114"><span class="linenos">114</span></a><span class="sd">            LoginCred | None: The loaded client credentials as a LoginCred object,</span>
</span><span id="PixivAuth-115"><a href="#PixivAuth-115"><span class="linenos">115</span></a><span class="sd">                or None if the file does not exist or the credentials are invalid.</span>
</span><span id="PixivAuth-116"><a href="#PixivAuth-116"><span class="linenos">116</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PixivAuth-117"><a href="#PixivAuth-117"><span class="linenos">117</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">auth_json_path</span><span class="p">)</span>
</span><span id="PixivAuth-118"><a href="#PixivAuth-118"><span class="linenos">118</span></a>        <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="PixivAuth-119"><a href="#PixivAuth-119"><span class="linenos">119</span></a>            <span class="n">cred_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">open</span><span class="p">())</span>
</span><span id="PixivAuth-120"><a href="#PixivAuth-120"><span class="linenos">120</span></a>            <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">cred_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="p">{</span><span class="s2">&quot;pixiv_id&quot;</span><span class="p">,</span> <span class="s2">&quot;password&quot;</span><span class="p">}:</span>
</span><span id="PixivAuth-121"><a href="#PixivAuth-121"><span class="linenos">121</span></a>                <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;LoginCred&quot;</span><span class="p">,</span> <span class="n">cred_data</span><span class="p">)</span>
</span><span id="PixivAuth-122"><a href="#PixivAuth-122"><span class="linenos">122</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="PixivAuth-123"><a href="#PixivAuth-123"><span class="linenos">123</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Pixiv Authentication class.</p>
</div>


                            <div id="PixivAuth.__init__" class="classattr">
                                        <input id="PixivAuth.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">PixivAuth</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">auth_json_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;client.json&#39;</span></span>)</span>

                <label class="view-source-button" for="PixivAuth.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PixivAuth.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PixivAuth.__init__-26"><a href="#PixivAuth.__init__-26"><span class="linenos">26</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auth_json_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;client.json&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PixivAuth.__init__-27"><a href="#PixivAuth.__init__-27"><span class="linenos">27</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the PixivAuth class.</span>
</span><span id="PixivAuth.__init__-28"><a href="#PixivAuth.__init__-28"><span class="linenos">28</span></a>
</span><span id="PixivAuth.__init__-29"><a href="#PixivAuth.__init__-29"><span class="linenos">29</span></a><span class="sd">        Args:</span>
</span><span id="PixivAuth.__init__-30"><a href="#PixivAuth.__init__-30"><span class="linenos">30</span></a><span class="sd">            auth_json_path (str): Path to the JSON file containing client credentials.</span>
</span><span id="PixivAuth.__init__-31"><a href="#PixivAuth.__init__-31"><span class="linenos">31</span></a><span class="sd">                Defaults to &quot;client.json&quot;.</span>
</span><span id="PixivAuth.__init__-32"><a href="#PixivAuth.__init__-32"><span class="linenos">32</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PixivAuth.__init__-33"><a href="#PixivAuth.__init__-33"><span class="linenos">33</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">auth_json_path</span> <span class="o">=</span> <span class="n">auth_json_path</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the PixivAuth class.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>auth_json_path (str):</strong>  Path to the JSON file containing client credentials.
Defaults to "client.json".</li>
</ul>
</div>


                            </div>
                            <div id="PixivAuth.auth_json_path" class="classattr">
                                <div class="attr variable">
            <span class="name">auth_json_path</span>

        
    </div>
    <a class="headerlink" href="#PixivAuth.auth_json_path"></a>
    
    

                            </div>
                            <div id="PixivAuth.auth" class="classattr">
                                        <input id="PixivAuth.auth-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">auth</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="n">pixivpy3</span><span class="o">.</span><span class="n">aapi</span><span class="o">.</span><span class="n">AppPixivAPI</span><span class="p">,</span> <span class="n"><a href="#LoginInfo">LoginInfo</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="PixivAuth.auth-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PixivAuth.auth"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PixivAuth.auth-35"><a href="#PixivAuth.auth-35"><span class="linenos">35</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">auth</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">AppPixivAPI</span><span class="p">,</span> <span class="n">LoginInfo</span><span class="p">]:</span>
</span><span id="PixivAuth.auth-36"><a href="#PixivAuth.auth-36"><span class="linenos">36</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Authenticate the user with Pixiv.</span>
</span><span id="PixivAuth.auth-37"><a href="#PixivAuth.auth-37"><span class="linenos">37</span></a>
</span><span id="PixivAuth.auth-38"><a href="#PixivAuth.auth-38"><span class="linenos">38</span></a><span class="sd">        This method attempts to log in to Pixiv using the provided credentials.</span>
</span><span id="PixivAuth.auth-39"><a href="#PixivAuth.auth-39"><span class="linenos">39</span></a><span class="sd">        It first checks for existing credentials in a JSON file. If the credentials</span>
</span><span id="PixivAuth.auth-40"><a href="#PixivAuth.auth-40"><span class="linenos">40</span></a><span class="sd">        are not found or if the login fails, it prompts the user for their ID and</span>
</span><span id="PixivAuth.auth-41"><a href="#PixivAuth.auth-41"><span class="linenos">41</span></a><span class="sd">        password. The method will retry the login process up to three times before</span>
</span><span id="PixivAuth.auth-42"><a href="#PixivAuth.auth-42"><span class="linenos">42</span></a><span class="sd">        raising a PixivLoginFailed exception.</span>
</span><span id="PixivAuth.auth-43"><a href="#PixivAuth.auth-43"><span class="linenos">43</span></a>
</span><span id="PixivAuth.auth-44"><a href="#PixivAuth.auth-44"><span class="linenos">44</span></a><span class="sd">        Returns:</span>
</span><span id="PixivAuth.auth-45"><a href="#PixivAuth.auth-45"><span class="linenos">45</span></a><span class="sd">            tuple[AppPixivAPI, LoginInfo]: A tuple containing the authenticated</span>
</span><span id="PixivAuth.auth-46"><a href="#PixivAuth.auth-46"><span class="linenos">46</span></a><span class="sd">                AppPixivAPI instance and the login information.</span>
</span><span id="PixivAuth.auth-47"><a href="#PixivAuth.auth-47"><span class="linenos">47</span></a>
</span><span id="PixivAuth.auth-48"><a href="#PixivAuth.auth-48"><span class="linenos">48</span></a><span class="sd">        Raises:</span>
</span><span id="PixivAuth.auth-49"><a href="#PixivAuth.auth-49"><span class="linenos">49</span></a><span class="sd">            PixivLoginFailed: If the login process fails after three attempts.</span>
</span><span id="PixivAuth.auth-50"><a href="#PixivAuth.auth-50"><span class="linenos">50</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PixivAuth.auth-51"><a href="#PixivAuth.auth-51"><span class="linenos">51</span></a>        <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="PixivAuth.auth-52"><a href="#PixivAuth.auth-52"><span class="linenos">52</span></a>        <span class="k">while</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>  <span class="c1"># noqa: PLR2004</span>
</span><span id="PixivAuth.auth-53"><a href="#PixivAuth.auth-53"><span class="linenos">53</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="PixivAuth.auth-54"><a href="#PixivAuth.auth-54"><span class="linenos">54</span></a>                <span class="n">aapi</span><span class="p">,</span> <span class="n">login_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__auth</span><span class="p">(</span><span class="n">cnt</span><span class="p">)</span>
</span><span id="PixivAuth.auth-55"><a href="#PixivAuth.auth-55"><span class="linenos">55</span></a>            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">UnboundLocalError</span><span class="p">):</span>
</span><span id="PixivAuth.auth-56"><a href="#PixivAuth.auth-56"><span class="linenos">56</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[?25h[!]: Failed to login. Check your ID or PW.&quot;</span><span class="p">)</span>
</span><span id="PixivAuth.auth-57"><a href="#PixivAuth.auth-57"><span class="linenos">57</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PixivAuth.auth-58"><a href="#PixivAuth.auth-58"><span class="linenos">58</span></a>                <span class="k">return</span> <span class="n">aapi</span><span class="p">,</span> <span class="n">login_info</span>
</span><span id="PixivAuth.auth-59"><a href="#PixivAuth.auth-59"><span class="linenos">59</span></a>            <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="PixivAuth.auth-60"><a href="#PixivAuth.auth-60"><span class="linenos">60</span></a>
</span><span id="PixivAuth.auth-61"><a href="#PixivAuth.auth-61"><span class="linenos">61</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[!]: The number of login attempts has been exceeded.&quot;</span><span class="p">)</span>
</span><span id="PixivAuth.auth-62"><a href="#PixivAuth.auth-62"><span class="linenos">62</span></a>        <span class="k">raise</span> <span class="n">PixivLoginFailedError</span>
</span></pre></div>


            <div class="docstring"><p>Authenticate the user with Pixiv.</p>

<p>This method attempts to log in to Pixiv using the provided credentials.
It first checks for existing credentials in a JSON file. If the credentials
are not found or if the login fails, it prompts the user for their ID and
password. The method will retry the login process up to three times before
raising a PixivLoginFailed exception.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>tuple[AppPixivAPI, LoginInfo]: A tuple containing the authenticated
      AppPixivAPI instance and the login information.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>PixivLoginFailed:</strong>  If the login process fails after three attempts.</li>
</ul>
</div>


                            </div>
                            <div id="PixivAuth.get_refresh_token" class="classattr">
                                        <input id="PixivAuth.get_refresh_token-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_refresh_token</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">pixiv_id</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">pixiv_pass</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="PixivAuth.get_refresh_token-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PixivAuth.get_refresh_token"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PixivAuth.get_refresh_token-87"><a href="#PixivAuth.get_refresh_token-87"><span class="linenos"> 87</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PixivAuth.get_refresh_token-88"><a href="#PixivAuth.get_refresh_token-88"><span class="linenos"> 88</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_refresh_token</span><span class="p">(</span><span class="n">pixiv_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pixiv_pass</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="PixivAuth.get_refresh_token-89"><a href="#PixivAuth.get_refresh_token-89"><span class="linenos"> 89</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the refresh token for the given Pixiv ID and password.</span>
</span><span id="PixivAuth.get_refresh_token-90"><a href="#PixivAuth.get_refresh_token-90"><span class="linenos"> 90</span></a>
</span><span id="PixivAuth.get_refresh_token-91"><a href="#PixivAuth.get_refresh_token-91"><span class="linenos"> 91</span></a><span class="sd">        This method uses the GetPixivToken class to perform the login and</span>
</span><span id="PixivAuth.get_refresh_token-92"><a href="#PixivAuth.get_refresh_token-92"><span class="linenos"> 92</span></a><span class="sd">        retrieve the refresh token.</span>
</span><span id="PixivAuth.get_refresh_token-93"><a href="#PixivAuth.get_refresh_token-93"><span class="linenos"> 93</span></a>
</span><span id="PixivAuth.get_refresh_token-94"><a href="#PixivAuth.get_refresh_token-94"><span class="linenos"> 94</span></a><span class="sd">        Args:</span>
</span><span id="PixivAuth.get_refresh_token-95"><a href="#PixivAuth.get_refresh_token-95"><span class="linenos"> 95</span></a><span class="sd">            pixiv_id (str): The Pixiv ID (email address, username, or account name).</span>
</span><span id="PixivAuth.get_refresh_token-96"><a href="#PixivAuth.get_refresh_token-96"><span class="linenos"> 96</span></a><span class="sd">            pixiv_pass (str): The password for the Pixiv account.</span>
</span><span id="PixivAuth.get_refresh_token-97"><a href="#PixivAuth.get_refresh_token-97"><span class="linenos"> 97</span></a>
</span><span id="PixivAuth.get_refresh_token-98"><a href="#PixivAuth.get_refresh_token-98"><span class="linenos"> 98</span></a><span class="sd">        Returns:</span>
</span><span id="PixivAuth.get_refresh_token-99"><a href="#PixivAuth.get_refresh_token-99"><span class="linenos"> 99</span></a><span class="sd">            str: The refresh token for the Pixiv account.</span>
</span><span id="PixivAuth.get_refresh_token-100"><a href="#PixivAuth.get_refresh_token-100"><span class="linenos">100</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PixivAuth.get_refresh_token-101"><a href="#PixivAuth.get_refresh_token-101"><span class="linenos">101</span></a>        <span class="n">g</span> <span class="o">=</span> <span class="n">GetPixivToken</span><span class="p">(</span><span class="n">headless</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="n">pixiv_id</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">pixiv_pass</span><span class="p">)</span>
</span><span id="PixivAuth.get_refresh_token-102"><a href="#PixivAuth.get_refresh_token-102"><span class="linenos">102</span></a>        <span class="k">return</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">login</span><span class="p">())[</span><span class="s2">&quot;refresh_token&quot;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Get the refresh token for the given Pixiv ID and password.</p>

<p>This method uses the GetPixivToken class to perform the login and
retrieve the refresh token.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>pixiv_id (str):</strong>  The Pixiv ID (email address, username, or account name).</li>
<li><strong>pixiv_pass (str):</strong>  The password for the Pixiv account.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>str: The refresh token for the Pixiv account.</p>
</blockquote>
</div>


                            </div>
                            <div id="PixivAuth.read_client_cred" class="classattr">
                                        <input id="PixivAuth.read_client_cred-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">read_client_cred</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n"><a href="#LoginCred">LoginCred</a></span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="PixivAuth.read_client_cred-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PixivAuth.read_client_cred"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PixivAuth.read_client_cred-104"><a href="#PixivAuth.read_client_cred-104"><span class="linenos">104</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">read_client_cred</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LoginCred</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PixivAuth.read_client_cred-105"><a href="#PixivAuth.read_client_cred-105"><span class="linenos">105</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Read the client credentials from the JSON file.</span>
</span><span id="PixivAuth.read_client_cred-106"><a href="#PixivAuth.read_client_cred-106"><span class="linenos">106</span></a>
</span><span id="PixivAuth.read_client_cred-107"><a href="#PixivAuth.read_client_cred-107"><span class="linenos">107</span></a><span class="sd">        This method checks if the JSON file containing the client credentials</span>
</span><span id="PixivAuth.read_client_cred-108"><a href="#PixivAuth.read_client_cred-108"><span class="linenos">108</span></a><span class="sd">        exists and attempts to load the credentials. If the credentials are</span>
</span><span id="PixivAuth.read_client_cred-109"><a href="#PixivAuth.read_client_cred-109"><span class="linenos">109</span></a><span class="sd">        successfully loaded and contain the required keys, they are returned</span>
</span><span id="PixivAuth.read_client_cred-110"><a href="#PixivAuth.read_client_cred-110"><span class="linenos">110</span></a><span class="sd">        as a LoginCred object. If the file does not exist or the credentials</span>
</span><span id="PixivAuth.read_client_cred-111"><a href="#PixivAuth.read_client_cred-111"><span class="linenos">111</span></a><span class="sd">        are invalid, None is returned.</span>
</span><span id="PixivAuth.read_client_cred-112"><a href="#PixivAuth.read_client_cred-112"><span class="linenos">112</span></a>
</span><span id="PixivAuth.read_client_cred-113"><a href="#PixivAuth.read_client_cred-113"><span class="linenos">113</span></a><span class="sd">        Returns:</span>
</span><span id="PixivAuth.read_client_cred-114"><a href="#PixivAuth.read_client_cred-114"><span class="linenos">114</span></a><span class="sd">            LoginCred | None: The loaded client credentials as a LoginCred object,</span>
</span><span id="PixivAuth.read_client_cred-115"><a href="#PixivAuth.read_client_cred-115"><span class="linenos">115</span></a><span class="sd">                or None if the file does not exist or the credentials are invalid.</span>
</span><span id="PixivAuth.read_client_cred-116"><a href="#PixivAuth.read_client_cred-116"><span class="linenos">116</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PixivAuth.read_client_cred-117"><a href="#PixivAuth.read_client_cred-117"><span class="linenos">117</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">auth_json_path</span><span class="p">)</span>
</span><span id="PixivAuth.read_client_cred-118"><a href="#PixivAuth.read_client_cred-118"><span class="linenos">118</span></a>        <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="PixivAuth.read_client_cred-119"><a href="#PixivAuth.read_client_cred-119"><span class="linenos">119</span></a>            <span class="n">cred_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">open</span><span class="p">())</span>
</span><span id="PixivAuth.read_client_cred-120"><a href="#PixivAuth.read_client_cred-120"><span class="linenos">120</span></a>            <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">cred_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="p">{</span><span class="s2">&quot;pixiv_id&quot;</span><span class="p">,</span> <span class="s2">&quot;password&quot;</span><span class="p">}:</span>
</span><span id="PixivAuth.read_client_cred-121"><a href="#PixivAuth.read_client_cred-121"><span class="linenos">121</span></a>                <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;LoginCred&quot;</span><span class="p">,</span> <span class="n">cred_data</span><span class="p">)</span>
</span><span id="PixivAuth.read_client_cred-122"><a href="#PixivAuth.read_client_cred-122"><span class="linenos">122</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="PixivAuth.read_client_cred-123"><a href="#PixivAuth.read_client_cred-123"><span class="linenos">123</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Read the client credentials from the JSON file.</p>

<p>This method checks if the JSON file containing the client credentials
exists and attempts to load the credentials. If the credentials are
successfully loaded and contain the required keys, they are returned
as a LoginCred object. If the file does not exist or the credentials
are invalid, None is returned.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>LoginCred | None: The loaded client credentials as a LoginCred object,
      or None if the file does not exist or the credentials are invalid.</p>
</blockquote>
</div>


                            </div>
                </section>
                <section id="PixivLoginFailedError">
                            <input id="PixivLoginFailedError-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PixivLoginFailedError</span><wbr>(<span class="base">builtins.Exception</span>):

                <label class="view-source-button" for="PixivLoginFailedError-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PixivLoginFailedError"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PixivLoginFailedError-7"><a href="#PixivLoginFailedError-7"><span class="linenos">7</span></a><span class="k">class</span><span class="w"> </span><span class="nc">PixivLoginFailedError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
</span><span id="PixivLoginFailedError-8"><a href="#PixivLoginFailedError-8"><span class="linenos">8</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Custom exception for Pixiv login failures.&quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Custom exception for Pixiv login failures.</p>
</div>


                </section>
                <section id="ProfileURIs">
                            <input id="ProfileURIs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ProfileURIs</span><wbr>(<span class="base">typing.TypedDict</span>):

                <label class="view-source-button" for="ProfileURIs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ProfileURIs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ProfileURIs-18"><a href="#ProfileURIs-18"><span class="linenos">18</span></a><span class="k">class</span><span class="w"> </span><span class="nc">ProfileURIs</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
</span><span id="ProfileURIs-19"><a href="#ProfileURIs-19"><span class="linenos">19</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Profile image URLs for Pixiv user.&quot;&quot;&quot;</span>
</span><span id="ProfileURIs-20"><a href="#ProfileURIs-20"><span class="linenos">20</span></a>
</span><span id="ProfileURIs-21"><a href="#ProfileURIs-21"><span class="linenos">21</span></a>    <span class="n">px_16x16</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="ProfileURIs-22"><a href="#ProfileURIs-22"><span class="linenos">22</span></a>    <span class="n">px_50x50</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="ProfileURIs-23"><a href="#ProfileURIs-23"><span class="linenos">23</span></a>    <span class="n">px_170x170</span><span class="p">:</span> <span class="nb">str</span>
</span></pre></div>


            <div class="docstring"><p>Profile image URLs for Pixiv user.</p>
</div>


                            <div id="ProfileURIs.px_16x16" class="classattr">
                                <div class="attr variable">
            <span class="name">px_16x16</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#ProfileURIs.px_16x16"></a>
    
    

                            </div>
                            <div id="ProfileURIs.px_50x50" class="classattr">
                                <div class="attr variable">
            <span class="name">px_50x50</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#ProfileURIs.px_50x50"></a>
    
    

                            </div>
                            <div id="ProfileURIs.px_170x170" class="classattr">
                                <div class="attr variable">
            <span class="name">px_170x170</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#ProfileURIs.px_170x170"></a>
    
    

                            </div>
                </section>
    </main>
</body>
</html>